<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Kiraan Gaji — Awam</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>
<script src="auth.js"></script>

<style>
/* =========================================
   PAGE TRANSITION STYLES
   ========================================= */
body {
    opacity: 0; /* Mula-mula page halimunan */
    transition: opacity 0.5s ease-in-out; /* Tempoh peralihan 0.5 saat */
    pointer-events: none; /* Halang klik masa tengah loading */
}

body.loaded {
    opacity: 1; /* Muncul sepenuhnya */
    pointer-events: auto; /* Boleh klik semula */
}
    /* ===== THEME VARIABLES (Sama dengan Dashboard) ===== */
    :root {
        --bg-main: #f8fafc;
        --bg-card: #ffffff;
        --text-primary: #0f172a;
        --text-secondary: #64748b;
        --brand-blue: #4f46e5;
        --brand-green: #10b981;
        --border-light: #e2e8f0;
        --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1);
        --shadow-md: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    }

    * { box-sizing: border-box; }

    body {
        margin: 0; padding: 0;
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-main);
        color: var(--text-primary);
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
        padding-bottom: 50px;
        opacity: 0; /* Mula dengan hidden untuk effect fade-in */
        transition: opacity 0.4s ease-in-out;
    }
    
    /* Class untuk trigger fade-in */
    body.loaded { opacity: 1; }

/* =========================================
   FULL PAGE MODERN BACKGROUND
   ========================================= */
.animated-bg {
    position: fixed; /* Guna fixed supaya ia kekal penuh walaupun scroll */
    top: 0; 
    left: 0; 
    width: 100%;
    height: 100%; /* Penuh satu skrin */
    
    /* Warna Moden Mesh Gradient */
    background-color: #f3f4f6;
    background-image: 
        radial-gradient(at 0% 0%, hsla(253,16%,7%,0) 0, transparent 50%), 
        radial-gradient(at 50% 0%, hsla(225,39%,30%,0) 0, transparent 50%), 
        radial-gradient(at 100% 0%, hsla(339,49%,30%,0) 0, transparent 50%);
        
    background-image: 
        radial-gradient(at 40% 20%, hsla(28,100%,74%,1) 0px, transparent 50%),
        radial-gradient(at 80% 0%, hsla(189,100%,56%,1) 0px, transparent 50%),
        radial-gradient(at 0% 50%, hsla(355,100%,93%,1) 0px, transparent 50%),
        radial-gradient(at 80% 50%, hsla(340,100%,76%,1) 0px, transparent 50%),
        radial-gradient(at 0% 100%, hsla(22,100%,77%,1) 0px, transparent 50%),
        radial-gradient(at 80% 100%, hsla(242,100%,70%,1) 0px, transparent 50%),
        radial-gradient(at 0% 0%, hsla(343,100%,76%,1) 0px, transparent 50%);

    /* Blur & Filter untuk efek lembut */
    filter: blur(60px); 
    opacity: 0.6; /* Transparansi supaya tak ganggu teks */
    z-index: -1;
    
    /* Animasi Pergerakan */
    background-size: 150% 150%;
    animation: gradientFull 15s ease infinite alternate;
}

@keyframes gradientFull {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

    /* NAVBAR */
    .dashboard-nav {
        display: flex; justify-content: space-between; align-items: center; padding: 15px 30px;
        background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255,255,255,0.6); position: sticky; top: 0; z-index: 100; margin-bottom: 20px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        /* TAMBAH 2 BARIS INI UNTUK SMOOTH */
    transition: transform 0.3s ease-in-out;
    will-change: transform;
}

/* TAMBAH CLASS BARU INI (Untuk sorok navbar) */
.dashboard-nav.nav-hidden {
    transform: translateY(-100%); /* Tarik navbar ke atas sampai hilang */
}
    
    .nav-left { display: flex; align-items: center; gap: 12px; }
    .nav-logo { height: 38px; }
    .nav-title { font-weight: 800; font-size: 1.1rem; color: #1e293b; }
    .nav-right { display: flex; gap: 20px; align-items: center; }
    
    .nav-link { text-decoration: none; color: #475569; font-weight: 600; font-size: 0.9rem; transition: 0.2s; position: relative; }
    .nav-link:hover, .nav-link.active { color: var(--brand-blue); }
    
    .logout-btn { background: #fee2e2; color: #ef4444; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; cursor: pointer; transition: 0.2s; }
    .logout-btn:hover { background: #fecaca; }

/* =========================================
   MODERN HEADER (RAPAT DENGAN NAV)
   ========================================= */
.custom-header {
    text-align: center;
    padding: 60px 20px 80px; /* Padding ditingkatkan supaya teks tak nampak sempit */
    
    /* === PENTING: Untuk Rapatkan dengan Nav === */
    margin-top: 0 !important;   /* Buang jarak atas */
    margin-bottom: 30px;        /* Jarak dengan content bawah */
    width: 100%;                /* Pastikan lebar penuh */
    
    /* WARNA BACKGROUND MESH */
    background-color: #eef2ff;
    background-image: 
        radial-gradient(at 80% 0%, hsla(189,100%,56%,0.3) 0px, transparent 50%),
        radial-gradient(at 0% 50%, hsla(355,100%,93%,1) 0px, transparent 50%),
        radial-gradient(at 80% 50%, hsla(340,100%,76%,0.1) 0px, transparent 50%),
        radial-gradient(at 0% 100%, hsla(22,100%,77%,0.3) 0px, transparent 50%),
        radial-gradient(at 80% 100%, hsla(242,100%,70%,0.3) 0px, transparent 50%),
        radial-gradient(at 0% 0%, hsla(343,100%,76%,0.3) 0px, transparent 50%);
    
    background-size: 200% 200%;
    animation: meshMove 15s ease-in-out infinite alternate;

    /* BENTUK: Atas rata, Bawah melengkung */
    border-top-left-radius: 0;  /* Rata supaya cantum dengan nav */
    border-top-right-radius: 0; /* Rata supaya cantum dengan nav */
    border-bottom-left-radius: 60px; /* Lengkung cantik di bawah */
    border-bottom-right-radius: 60px;
    
    /* Shadow */
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.05);
    position: relative;
    z-index: 1;
}

/* Style Teks */
.custom-header h1 {
    font-size: 1.8rem;
    margin: 0 0 10px 0;
    font-weight: 800;
    color: #1e293b;
    text-transform: uppercase;
    letter-spacing: -0.5px;
}

.custom-header p {
    font-size: 1rem;
    color: #475569;
    margin: 0;
    font-weight: 600;
}

@keyframes meshMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
/* Tambah ini jika nav anda ada margin */
nav, .navbar {
    margin-bottom: 0 !important;
    box-shadow: none !important; /* Buang shadow nav supaya nampak bersambung */
    border-bottom: none !important;
}
    .main { display: flex; justify-content: center; padding: 0 20px; position: relative; z-index: 2; }
    .panel {
        background: var(--bg-card); border: 1px solid var(--border-light); border-radius: 20px;
        padding: 35px; box-shadow: var(--shadow-md); width: 100%; max-width: 900px; transition: transform 0.3s;
    }
    
    /* FORM & INPUTS */
    .dropdown-wrapper { margin-bottom: 20px; }
    label { font-weight: 600; font-size: 0.9rem; color: var(--text-secondary); display: block; margin-bottom: 6px; }
    select, input[type="text"], input[type="number"] {
        width: 100%; padding: 14px; border: 1px solid var(--border-light); border-radius: 10px;
        font-size: 0.95rem; font-family: 'Inter', sans-serif; background: #f8fafc; color: var(--text-primary); outline: none; transition: 0.2s;
    }
    select:focus, input:focus { border-color: var(--brand-blue); background: #fff; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }
    
    .row { display: flex; gap: 20px; margin-bottom: 15px; }
    .col { flex: 1; }

    /* BUTTONS */
    .btn {
        width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: 700; cursor: pointer;
        background: var(--brand-blue); color: white; margin-top: 15px; font-size: 1rem; transition: 0.2s;
        box-shadow: 0 4px 6px rgba(79, 70, 229, 0.2);
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(79, 70, 229, 0.3); }
    .btn:active { transform: scale(0.98); }
    
    .btn.secondary { background: white; color: var(--text-secondary); border: 2px solid var(--border-light); box-shadow: none; }
    .btn.secondary:hover { background: #f1f5f9; color: var(--text-primary); }
    .btn.print { background: var(--brand-green); color: white; margin-top: 0; box-shadow: 0 4px 6px rgba(16, 185, 129, 0.2); }
    .btn.print:hover { background: #059669; }

    .action-buttons { display: flex; gap: 10px; margin-top: 15px; }

    /* NAV TOGGLE */
    .navwrap { display: flex; justify-content: center; margin-bottom: 25px; position: relative; z-index: 2; }
    .nav { display: flex; gap: 15px; background: rgba(255,255,255,0.6); padding: 5px; border-radius: 50px; backdrop-filter: blur(10px); box-shadow: var(--shadow-sm); }
    .nav a { text-decoration: none; }
    .circle { padding: 10px 30px; border-radius: 30px; font-weight: 700; font-size: 0.9rem; transition: 0.3s; }
    .circle.active { background: var(--brand-blue); color: white; box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3); }
    .circle.inactive { color: var(--text-secondary); }
    .circle.inactive:hover { background: rgba(255,255,255,0.8); color: var(--brand-blue); }

    /* BOXES & RESULT */
    .info-box { background: #eff6ff; border-left: 4px solid var(--brand-blue); padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem; line-height: 1.6; color: #1e3a8a; }
    
    .result-box { 
        background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; padding: 25px; border-radius: 12px; margin-top: 25px; 
        animation: slideUp 0.6s ease-out;
    }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .breakdown-table { width: 100%; margin-bottom: 15px; font-size: 0.9rem; border-collapse: collapse; }
    .breakdown-table td { padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
    .breakdown-table td:last-child { text-align: right; font-weight: 600; }

    /* POPUP & FLOATING */
    .petunjuk-btn { position: fixed; bottom: 30px; left: 30px; width: 50px; height: 50px; background: var(--brand-blue); color: white; border: none; border-radius: 50%; font-size: 24px; font-weight: bold; cursor: pointer; box-shadow: var(--shadow-md); z-index: 99; transition: 0.2s; }
    .petunjuk-btn:hover { transform: scale(1.1); }
    
    #goTopBtn {
        display: none; position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px;
        background: var(--text-primary); color: white; border: none; border-radius: 50%;
        font-size: 20px; cursor: pointer; box-shadow: var(--shadow-md); z-index: 99; transition: 0.3s;
    }
    #goTopBtn:hover { background: var(--brand-blue); transform: translateY(-3px); }

    .petunjuk-popup { display: none; position: fixed; bottom: 90px; left: 30px; background: white; padding: 20px; border-radius: 16px; box-shadow: var(--shadow-md); z-index: 100; border: 1px solid var(--border-light); width: 300px; }
    .petunjuk-popup table { width: 100%; font-size: 0.85rem; }
    .petunjuk-popup td { padding: 6px 0; border-bottom: 1px solid #f1f5f9; }

    @media (max-width: 768px) {
        .dashboard-nav { padding: 15px; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .nav-right { gap: 15px; font-size: 0.85rem; }
        .nav-title { font-weight: 800; font-size: 1.1rem; color: #1e293b; }
        .row { flex-direction: column; gap: 10px; } 
        .panel { padding: 20px; }
        .custom-header h1 { font-size: 1.3rem; }
        .btn { padding: 12px; }
        .petunjuk-btn { left: 20px; bottom: 20px; }
        #goTopBtn { right: 20px; bottom: 20px; }
    }

/* === TOOLTIP STYLES (Tambah ini) === */

/* Pastikan elemen induk ada position relative */
.nav-link, .logout-btn {
    position: relative;
}

/* Kotak Teks Tooltip */
[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    margin-top: 10px;
    padding: 6px 10px;
    background-color: #1e293b; /* Warna latar gelap */
    color: #fff;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 6px;
    white-space: nowrap;
    opacity: 0;
    animation: tooltipFade 0.3s forwards;
    pointer-events: none;
    z-index: 200;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

/* Anak Panah Kecil (Segitiga) di atas tooltip */
[data-tooltip]:hover::before {
    content: '';
    position: absolute;
    top: 100%; 
    left: 50%;
    transform: translateX(-50%);
    margin-top: 5px;
    border-width: 5px;
    border-style: solid;
    border-color: transparent transparent #1e293b transparent; /* Warna sama dengan background tooltip */
    opacity: 0;
    animation: tooltipFade 0.3s forwards;
    pointer-events: none;
}

/* Animasi Muncul */
@keyframes tooltipFade { 
    to { opacity: 1; margin-top: 10px; } 
}

/* Sembunyikan tooltip pada Mobile supaya tak semak */
@media (max-width: 768px) {
    [data-tooltip]:hover::after, [data-tooltip]:hover::before { display: none; }
}
/* ===== CSS NAVIGASI HYBRID ===== */

.dashboard-nav {
    display: flex; justify-content: space-between; align-items: center; 
    padding: 15px 30px;
    background: rgba(255, 255, 255, 0.95); 
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(255,255,255,0.6); 
    position: sticky; top: 0; z-index: 100;
    margin-bottom: 0;
    height: 70px; /* Tinggi Tetap */
}

/* --- DESKTOP VIEW (Title Sebelah Logo) --- */
.nav-left { 
    display: flex; 
    align-items: center; 
    gap: 15px; /* Jarak antara logo dan title */
}

.nav-logo { height: 38px; }

.nav-title { 
    font-weight: 800; 
    font-size: 1.1rem; 
    color: #1e293b; 
    /* Desktop: Jangan kacau position, biar dia duduk sebelah logo */
    position: static; 
    transform: none;
}

/* Menu Desktop */
.nav-right { display: flex; gap: 20px; align-items: center; }
.nav-link { text-decoration: none; color: #475569; font-weight: 600; font-size: 0.9rem; transition: 0.2s; }
.nav-link:hover, .nav-link.active { color: var(--brand-blue); }
.logout-btn { background: #fee2e2; color: #ef4444; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; cursor: pointer; }

/* Burger Default Hidden */
.hamburger { display: none; cursor: pointer; flex-direction: column; gap: 5px; z-index: 50; }
.hamburger span { width: 25px; height: 3px; background-color: #0f172a; border-radius: 2px; transition: 0.3s; }


/* --- MOBILE RESPONSIVE (Title Jadi Center Sini) --- */
@media (max-width: 768px) {
    .dashboard-nav { padding: 0 20px; } /* Kurangkan padding tepi */

    /* 1. Tunjuk Burger */
    .hamburger { display: flex; }

    /* 2. MAGIC: Title Lari ke Tengah */
    .nav-title {
        position: absolute; /* Cabut dari .nav-left */
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%); /* Center betul-betul */
        
        font-size: 0.95rem; /* Kecilkan sikit */
        width: 60%; /* Hadkan lebar supaya tak langgar logo/burger */
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        z-index: 10;
    }

    /* 3. Menu Dropdown */
    .nav-right {
        position: absolute;
        top: 70px;
        left: 0;
        width: 100%;
        background: white;
        border-bottom: 1px solid #e2e8f0;
        box-shadow: 0 10px 15px rgba(0,0,0,0.05);
        
        display: flex; flex-direction: column; align-items: center;
        max-height: 0; opacity: 0; overflow: hidden;
        transition: all 0.4s ease-in-out;
        padding: 0; gap: 0;
    }

    .nav-right.active {
        max-height: 400px;
        opacity: 1;
        padding: 20px 0;
        gap: 15px;
    }

    .nav-link { width: 100%; padding: 12px; display: block; text-align: center; }
    
    /* Burger Animation */
    .nav-right.active ~ .hamburger span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
    .nav-right.active ~ .hamburger span:nth-child(2) { opacity: 0; }
    .nav-right.active ~ .hamburger span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
}
</style>
</head>
<body data-kiraan="awam">

    <div class="animated-bg"></div>

<nav class="dashboard-nav">
    
    <div class="nav-left">
        <img src="image/HASA.png" class="nav-logo" alt="Logo">
        <span class="nav-title">SISTEM KIRAAN GAJI</span>
    </div>
    
    <div class="hamburger" id="hamburgerBtn">
        <span></span><span></span><span></span>
    </div>

    <div class="nav-right" id="navMenu">
        <a href="dashboard.html" class="nav-link" data-tooltip="Paparan Utama">Dashboard</a>
        <a href="contohawam.html" class="nav-link active" data-tooltip="Kiraan Sektor Kerajaan">Kiraan Awam</a>
        <a href="swasta.html" class="nav-link" data-tooltip="Kiraan Sektor Korporat">Kiraan Swasta</a>
        <button id="logoutBtn" class="logout-btn" data-tooltip="Keluar Sistem">Logout</button>
    </div>
</nav>

    <header class="custom-header">
        <h1>KIRAAN GAJI SEKTOR AWAM</h1> 
        <p>Kerajaan / Badan Berkanun / PBT</p>
    </header>

    <div class="navwrap">
        <div class="nav">
            <a href="contohawam.html" class="transition-link"><div class="circle active">AWAM</div></a>
            <a href="swasta.html" class="transition-link"><div class="circle inactive">SWASTA</div></a>
        </div>
    </div>

    <div class="main">
        <div class="panel">
            <div class="info-box">
                <strong>Panduan:</strong> Pilih Jawatan dan Wilayah Asal. Tentukan status PGT (Pergerakan Gaji Tahunan). Elaun adalah tetap mengikut jawatan. Tekan butang <strong>KIRA GAJI AWAM</strong> untuk lihat keputusan.
            </div>

            <div class="dropdown-wrapper">
                <label>Pilih Jawatan Awam</label>
                <select id="jawatan_awam">
                    <option value="" disabled selected>-- Sila Pilih --</option>
                    <option value="Juruteknik Perubatan U1">JURUTEKNIK PERUBATAN U1</option>
                    <option value="Pembantu Perawatan Kesihatan U1">PEMBANTU PERAWATAN KESIHATAN U1</option>
                    <option value="Pembantu Pembedahan Pergigian U1">PEMBANTU PEMBEDAHAN PERGIGIAN U1</option>
                    <option value="Penolong Pegawai Kesihatan Persekitaran U5">PENOLONG PEGAWAI KESIHATAN PERSEKITARAN U5</option>
                    <option value="Juruteknologi Makmal Perubatan U5">JURUTEKNOLOGI MAKMAL PERUBATAN U5</option>
                    <option value="Penolong Pegawai Farmasi U5">PENOLONG PEGAWAI FARMASI U5</option>
                    <option value="Juru X-Ray U5">JURU X-RAY U5</option>
                    <option value="Jurupulih Perubatan U5 - Diploma Fisioterapi">JURUPULIH PERUBATAN U5 - FISIOTERAPI</option>
                    <option value="Jurupulih Perubatan U5 - DLKM">JURUPULIH PERUBATAN U5 - DLKM</option>
                    <option value="Jurupulih Perubatan U5 - DKM">JURUPULIH PERUBATAN U5 - DKM</option>
                    <option value="Penolong Pegawai Perubatan U5">PENOLONG PEGAWAI PERUBATAN U5</option>
                    <option value="Jururawat U5">JURURAWAT U5</option>
                    <option value="Penolong Pegawai Perubatan U9">PENOLONG PEGAWAI PERUBATAN U9</option>
                    <option value="Pegawai kesihatan Persekitaran U9">PEGAWAI KESIHATAN PERSEKITARAN U9</option>
                    <option value="Pegawai Pemulihan Perubatan U9">PEGAWAI PEMULIHAN PERUBATAN U9</option>
                    <option value="Pegawai Dietetik U9">PEGAWAI DIETETIK U9</option>
                    <option value="Pegawai Optometri U9">PEGAWAI OPTOMETRI U9</option>
                    <option value="Juru X-Ray U9">JURU X-RAY U9</option>
                    <option value="Jururawat U9">JURURAWAT U9</option>
                    <option value="Pegawai Farmasi U9">PEGAWAI FARMASI U9</option>
                    <option value="Pegawai Pergigian UG9">PEGAWAI PERGIGIAN UG9</option>
                    <option value="Pegawai Perubatan UD10">PEGAWAI PERUBATAN UD10</option>
                    <option value="Pegawai Perubatan UD12">PEGAWAI PERUBATAN UD12</option>
                    <option value="Pegawai Perubatan UD13">PEGAWAI PERUBATAN UD13</option>
                    <option value="Pegawai Perubatan UD14">PEGAWAI PERUBATAN UD14</option>
                    <option value="Pegawai Perubatan Pakar UD13">PEGAWAI PERUBATAN PAKAR UD13</option>
                    <option value="Pegawai Perubatan Pakar UD14">PEGAWAI PERUBATAN PAKAR UD14</option>
                    <option value="Pegawai Perubatan Pakar UD15">PEGAWAI PERUBATAN PAKAR UD15</option>
                </select>
            </div>

            <div class="row">
                <div class="col">
                    <label>Wilayah Asal</label>
                    <select id="wilayah_awam">
                        <option value="" disabled selected>-- Pilih --</option>
                        <option value="Semenanjung">Semenanjung</option>
                        <option value="Sabah">Sabah</option>
                        <option value="Sarawak">Sarawak</option>
                        <option value="Labuan">Labuan</option>
                    </select>
                </div>
                <div class="col">
                    <label>Kategori</label>
                    <input type="text" id="kategoriJawatan" readonly style="background:#f1f5f9; color:#64748b;">
                </div>
            </div>

            <div class="row">
                <div class="col"><label>Gaji Pokok (RM)</label><input type="number" id="awamGajiPokok"></div>
                <div class="col"><label>Jawatan</label><input type="text" id="awamJawatan" readonly></div>
            </div>

            <div style="margin-top:25px; border-bottom:1px solid #e2e8f0; margin-bottom:15px; padding-bottom:5px; font-weight:700; color:#475569;">
                PERINCIAN ELAUN
            </div>
            
            <div class="row">
                <div class="col"><label>ITKA</label><input type="number" id="elaun_itka_awam" readonly></div>
                <div class="col"><label>ITK</label><input type="number" id="elaun_itk_awam" readonly></div>
                <div class="col"><label>ITP</label><input type="number" id="elaun_itp_awam" readonly></div> 
            </div>    
            <div class="row">
                <div class="col"><label>BISH</label><input type="number" id="elaun_bish_awam" readonly></div>
                <div class="col"><label>BIW</label><input type="number" id="elaun_biw_awam" readonly></div>
            </div>
            <div class="row">
                <div class="col"><label>BIPK</label><input type="number" id="elaun_bipk_awam" readonly></div>
                <div class="col"><label>BIP</label><input type="number" id="elaun_bip_awam" readonly></div>
            </div>

            <div class="row">
                <div class="col"><label>KGT Tahun Ini</label><input type="number" id="kgt_tahun_ini" readonly></div>
                <div class="col"><label>KGT Tambahan</label><input type="number" id="kgt_tambahan" readonly></div>
            </div>

            <div class="row">
                <div class="col">
                    <label>Dapat PGT Tahun Ini?</label>
                    <select id="awamTelah"><option value="YA">YA</option><option value="TIDAK" selected>TIDAK</option></select>
                </div>
                <div class="col">
                    <label>Bulan PGT</label>
                    <select id="awamPGT"><option value="Jan">Januari</option><option value="Apr">April</option><option value="Jul">Julai</option><option value="Oct">Oktober</option></select>
                </div>
            </div>

            <button class="btn" onclick="computeAwam()">KIRA GAJI AWAM</button>

            <div id="resultContent"></div>

            <div class="action-buttons">
                <button class="btn secondary" onclick="resetForm()">RESET</button>
                <button class="btn print" id="printBtn" onclick="printResult()" style="display:none;">CETAK SLIP</button>
            </div>
        </div>
    </div>

    <button id="petunjukBtn" class="petunjuk-btn">?</button>
    <button id="goTopBtn" title="Go to Top">↑</button>

    <div id="petunjukPopup" class="petunjuk-popup">
        <h4 style="color:var(--brand-blue); margin-top:0;">PETUNJUK ELAUN</h4>
        <table>
            <tr><td><strong>ITKA</strong></td><td>Imbuhan Tetap Khidmat Awam</td></tr>
            <tr><td><strong>ITK</strong></td><td>Imbuhan Tetap Keraian</td></tr>
            <tr><td><strong>ITP</strong></td><td>Imbuhan Tetap Perumahan</td></tr>
            <tr><td><strong>BISH</strong></td><td>Bantuan Sara Hidup</td></tr>
            <tr><td><strong>BIW</strong></td><td>Bayaran Insentif Wilayah</td></tr>
        </table>
    </div>

    <script>
        // 1. FADE IN & SMOOTH TRANSITION
        document.addEventListener("DOMContentLoaded", () => {
            document.body.classList.add("loaded");
            
            // Link transition
            document.querySelectorAll('.transition-link').forEach(link => {
                link.addEventListener('click', e => {
                    e.preventDefault();
                    const href = link.getAttribute('href');
                    document.body.style.opacity = 0;
                    setTimeout(() => { window.location.href = href; }, 400);
                });
            });
        });

        // 2. LOGOUT WITH NOTIFICATION (Sama Dashboard)
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            const notif = document.createElement('div');
            notif.textContent = 'Sedang Log Keluar...';
            notif.style.cssText = "position:fixed; top:20px; left:50%; transform:translateX(-50%); background-color: var(--brand-blue); color:white; padding:12px 24px; border-radius:30px; font-weight:600; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index:9999; opacity:0; transition:all 0.3s ease;";
            document.body.appendChild(notif);
            setTimeout(() => { notif.style.opacity = 1; notif.style.top = '30px'; }, 10);
            
            setTimeout(async () => {
                await firebase.auth().signOut();
                location.href = 'login.html';
            }, 1200);
        });

        // 3. UI UTILS (Popup & GoTop)
        const pBtn = document.getElementById('petunjukBtn');
        const pPop = document.getElementById('petunjukPopup');
        pBtn.onclick = () => { pPop.style.display = pPop.style.display === 'block' ? 'none' : 'block'; };

        const goTop = document.getElementById("goTopBtn");
        window.onscroll = () => { goTop.style.display = window.scrollY > 300 ? "block" : "none"; };
        goTop.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });

        // 4. DATA AWAM
        const jawatanAwam = {
            "Juruteknik Perubatan U1": { kategori: "Pelaksana (KUMP. C)", gajiPokok: 2000, KGT_tahun_ini: 100, KGT_tambahan: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:0, BIPK:300, BIP:0 }, "Sarawak": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Pembantu Perawatan Kesihatan U1": { kategori: "PELAKSANA (KUMP. C)", gajiPokok: 2000, KGT_tahun_ini: 100, KGT_tambahan: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:0, BIPK:300, BIP:0 }, "Sarawak": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Pembantu Pembedahan Pergigian U1": { kategori: "PELAKSANA (KUMP. C)", gajiPokok: 2000, KGT_tahun_ini: 100, KGT_tambahan: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:0, BIPK:300, BIP:0 }, "Sarawak": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Penolong Pegawai Kesihatan Persekitaran U5": { kategori: "PELAKSANA (KUMP. C)", gajiPokok: 2100, KGT_tahun_ini: 100, KGT_tambahan: 100, elaun: { "Semenanjung": { ITKA:0, ITK:115, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Juruteknologi Makmal Perubatan U5": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Penolong Pegawai Farmasi U5": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Juru X-Ray U5": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Jurupulih Perubatan U5 - Diploma Fisioterapi": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Jurupulih Perubatan U5 - DLKM": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Jurupulih Perubatan U5 - DKM": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Penolong Pegawai Perubatan U5": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Jururawat U5": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2000, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Penolong Pegawai Perubatan U9": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2500, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Pegawai kesihatan Persekitaran U9": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2500, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Pegawai Pemulihan Perubatan U9": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 2800, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Pegawai Dietetik U9": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 2800, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Pegawai Optometri U9": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 2800, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Juru X-Ray U9": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2500, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Jururawat U9": { kategori: "PELAKSANA (KUMP. B)", gajiPokok: 2500, KGT_tahun_ini: 145, KGT_tambahan: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
            "Pegawai Farmasi U9": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 3000, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Pegawai Pergigian UG9": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 3200, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Pegawai Perubatan UD10": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 3500, KGT_tahun_ini: 225, KGT_tambahan: 225, elaun: { "Semenanjung": { ITKA:0, ITK:300, ITP:400, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:300, ITP:400, BISH:0, BIW:400, BIPK:0, BIP:0 } } },
            "Pegawai Perubatan UD12": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 4000, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:400, ITP:500, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 } } },
            "Pegawai Perubatan UD13": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 4500, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:400, ITP:500, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 } } },
            "Pegawai Perubatan UD14": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 5000, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:400, ITP:500, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Sarawak": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 }, "Labuan": { ITKA:0, ITK:400, ITP:500, BISH:0, BIW:500, BIPK:0, BIP:0 } } },
            "Pegawai Perubatan Pakar UD13": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 5500, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:600, ITP:600, BISH:300, BIW:0, BIPK:0, BIP:1000 }, "Sabah": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1000 }, "Sarawak": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1000 }, "Labuan": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1000 } } },
            "Pegawai Perubatan Pakar UD14": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 6000, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:600, ITP:600, BISH:300, BIW:0, BIPK:0, BIP:1500 }, "Sabah": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1500 }, "Sarawak": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1500 }, "Labuan": { ITKA:0, ITK:600, ITP:600, BISH:0, BIW:600, BIPK:0, BIP:1500 } } },
            "Pegawai Perubatan Pakar UD15": { kategori: "PENGURUSAN DAN PROFESIONAL (KUMP. A)", gajiPokok: 6500, KGT_tahun_ini: 250, KGT_tambahan: 250, elaun: { "Semenanjung": { ITKA:0, ITK:800, ITP:800, BISH:300, BIW:0, BIPK:0, BIP:2000 }, "Sabah": { ITKA:0, ITK:800, ITP:800, BISH:0, BIW:800, BIPK:0, BIP:2000 }, "Sarawak": { ITKA:0, ITK:800, ITP:800, BISH:0, BIW:800, BIPK:0, BIP:2000 }, "Labuan": { ITKA:0, ITK:800, ITP:800, BISH:0, BIW:800, BIPK:0, BIP:2000 } } }
        };

        const els = {
            jawatan: document.getElementById('jawatan_awam'),
            wilayah: document.getElementById('wilayah_awam'),
            kategori: document.getElementById('kategoriJawatan'),
            jawatanKini: document.getElementById('awamJawatan'),
            gajiPokok: document.getElementById('awamGajiPokok'),
            telahPGT: document.getElementById('awamTelah'),
            itka: document.getElementById('elaun_itka_awam'),
            itk: document.getElementById('elaun_itk_awam'),
            itp: document.getElementById('elaun_itp_awam'),
            bish: document.getElementById('elaun_bish_awam'),
            biw: document.getElementById('elaun_biw_awam'),
            bipk: document.getElementById('elaun_bipk_awam'),
            bip: document.getElementById('elaun_bip_awam'),
            kgt: document.getElementById('kgt_tahun_ini'),
            kgtAdd: document.getElementById('kgt_tambahan'),
            result: document.getElementById('resultContent'),
            printBtn: document.getElementById('printBtn')
        };

        let calculatedData = {};

        els.jawatan.addEventListener('change', updateForm);
        els.wilayah.addEventListener('change', updateForm);

        function updateForm() {
            const j = els.jawatan.value;
            const w = els.wilayah.value;
            if(!j || !w) return;

            const data = jawatanAwam[j];
            const elaun = data.elaun[w];

            els.kategori.value = data.kategori;
            els.jawatanKini.value = j;
            if(!els.gajiPokok.value) els.gajiPokok.value = data.gajiPokok; 

            els.itka.value = elaun.ITKA;
            els.itk.value = elaun.ITK;
            els.itp.value = elaun.ITP;
            els.bish.value = elaun.BISH;
            els.biw.value = elaun.BIW;
            els.bipk.value = elaun.BIPK;
            els.bip.value = elaun.BIP;

            els.kgt.value = data.KGT_tahun_ini;
            els.kgtAdd.value = data.KGT_tambahan;
        }

        function computeAwam() {
            const basic = parseFloat(els.gajiPokok.value) || 0;
            const kgt = parseFloat(els.kgt.value) || 0;
            const kgtAdd = parseFloat(els.kgtAdd.value) || 0;
            
            const allowances = {
                'ITKA': parseFloat(els.itka.value) || 0,
                'ITK': parseFloat(els.itk.value) || 0,
                'ITP': parseFloat(els.itp.value) || 0,
                'BISH': parseFloat(els.bish.value) || 0,
                'BIW': parseFloat(els.biw.value) || 0,
                'BIPK': parseFloat(els.bipk.value) || 0,
                'BIP': parseFloat(els.bip.value) || 0
            };

            let totalElaun = 0;
            for (let key in allowances) totalElaun += allowances[key];

            let finalBasic = basic;
            if (els.telahPGT.value === 'TIDAK') finalBasic += kgt;
            finalBasic += kgtAdd;

            const grandTotal = finalBasic + totalElaun;

            // Generate Table HTML for Result Box
            let breakdownHTML = '<table class="breakdown-table">';
            for(let [key, val] of Object.entries(allowances)){
                if(val > 0) breakdownHTML += `<tr><td>${key}</td><td>RM ${val.toFixed(2)}</td></tr>`;
            }
            breakdownHTML += '</table>';

            calculatedData = {
                nama: firebase.auth().currentUser ? firebase.auth().currentUser.email : 'Pengguna',
                jawatan: els.jawatan.value,
                gajiAsal: basic,
                gajiBaru: finalBasic,
                elaun: totalElaun,
                kasar: grandTotal,
                tarikh: new Date().toLocaleString()
            };

            els.result.innerHTML = `
                <div class="result-box">
                    <h3 style="margin-top:0; border-bottom:1px solid #bbf7d0; padding-bottom:10px; color:#166534">Ringkasan Keputusan</h3>
                    
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:600;">
                        <span>Gaji Pokok Baru:</span> <span>RM ${finalBasic.toFixed(2)}</span>
                    </div>
                    
                    <div style="margin:10px 0;">
                        <strong style="font-size:0.9rem; color:#15803d;">Perincian Elaun:</strong>
                        ${breakdownHTML}
                    </div>

                    <div style="display:flex; justify-content:space-between; border-top:2px solid #bbf7d0; padding-top:10px; font-size:1.2rem; font-weight:800; color:#14532d;">
                        <span>JUMLAH KASAR:</span> <span>RM ${grandTotal.toFixed(2)}</span>
                    </div>
                </div>
            `;
            els.printBtn.style.display = 'inline-block';

            // AUTO SCROLL
            els.result.scrollIntoView({ behavior: 'smooth', block: 'start' });

            saveRecord({ jenis_kiraan: 'Kiraan Awam', jawatan: els.jawatan.value, gaji_pokok: finalBasic, jumlah_kasar: grandTotal, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
        }

        async function saveRecord(data){
            const user = firebase.auth().currentUser;
            if(user){ try { await firebase.firestore().collection('printedSlips').add({ userId: user.uid, ...data }); } catch(e){} }
        }

        function resetForm() {
            document.querySelectorAll('input').forEach(i => i.value = '');
            document.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
            els.result.innerHTML = '';
            els.printBtn.style.display = 'none';
        }

        function printResult() {
            const w = window.open('', '', 'width=800,height=600');
            const d = calculatedData;
            
            w.document.write(`
                <html><head><title>Slip Gaji Awam</title>
                <style>
                    body{ font-family: sans-serif; padding: 20px; }
                    .header{ text-align:center; border-bottom:2px solid #000; padding-bottom:10px; margin-bottom:20px; }
                    .watermark{ position:fixed; top:40%; left:20%; font-size:80px; color:rgba(0,0,0,0.05); transform:rotate(-30deg); z-index:-1; }
                    table{ width:100%; border-collapse:collapse; margin-top:20px; }
                    th, td{ border:1px solid #ccc; padding:8px; text-align:left; }
                    th{ background:#f0f0f0; }
                    .total{ font-size:1.2rem; font-weight:bold; background:#eef2ff; }
                    .warning-box { margin-top:30px; border:1px solid #f59e0b; padding:10px; font-size:0.85rem; color:#92400e; background:#fffbeb; text-align:center;}
                </style>
                </head><body>
                <div class="watermark">RUJUKAN SAHAJA</div>
                <div class="header"><h2>HASA UiTM</h2><p>Sistem Kiraan Gaji - Sektor Awam</p></div>
                <p><strong>Nama / ID:</strong> ${d.nama}</p>
                <p><strong>Jawatan:</strong> ${d.jawatan}</p>
                <p><strong>Tarikh Cetakan:</strong> ${d.tarikh}</p>
                <table>
                    <tr><th>Perkara</th><th>Amaun (RM)</th></tr>
                    <tr><td>Gaji Pokok Asal</td><td>${d.gajiAsal.toFixed(2)}</td></tr>
                    <tr><td>Gaji Pokok Baru (Selepas KGT)</td><td>${d.gajiBaru.toFixed(2)}</td></tr>
                    <tr><td>Jumlah Elaun Tetap</td><td>${d.elaun.toFixed(2)}</td></tr>
                    <tr class="total"><td>JUMLAH PENDAPATAN KASAR</td><td>${d.kasar.toFixed(2)}</td></tr>
                </table>
                
                <div class="warning-box">
                    <strong>PERHATIAN:</strong> Jumlah yang dipaparkan adalah anggaran rujukan sahaja. Keputusan muktamad tertakluk kepada semakan rasmi oleh pihak pentadbiran UiTM.
                </div>
                
                <div style="margin-top:10px; font-size:0.8rem; color:#555; text-align:center;">*Dokumen ini adalah cetakan komputer.</div>
                <script>window.print();<\/script>
                </body></html>
            `);
            w.document.close();
        }
        /* =========================================
   PAGE TRANSITION LOGIC
   ========================================= */
document.addEventListener("DOMContentLoaded", () => {
    
    // 1. FADE IN (Bila page baru buka)
    // Kita bagi sedikit masa (10ms) supaya browser sempat render
    setTimeout(() => {
        document.body.classList.add("loaded");
    }, 10);

    // 2. FADE OUT (Bila klik link navigasi)
    // Cari semua link (<a>) dalam page
    const links = document.querySelectorAll('a');

    links.forEach(link => {
        link.addEventListener('click', (e) => {
            const targetUrl = link.getAttribute('href');

            // Pastikan link tu bukan link kosong (#) atau javascript
            if (targetUrl && targetUrl !== '#' && !targetUrl.startsWith('javascript')) {
                e.preventDefault(); // Halang browser buka terus
                
                // Buat animasi hilang dulu (Fade Out)
                document.body.classList.remove("loaded");

                // Tunggu 0.5 saat (sama dengan masa transition CSS), baru pergi ke page lain
                setTimeout(() => {
                    window.location.href = targetUrl;
                }, 500); 
            }
        });
    });
});
document.addEventListener("DOMContentLoaded", () => {
    const navBtn = document.getElementById('hamburgerBtn');
    const navMenu = document.getElementById('navMenu');
    
    if(navBtn && navMenu) {
        navBtn.onclick = () => {
            navMenu.classList.toggle('active');
        };
    }
});
// Variable untuk simpan kedudukan scroll terakhir
let lastScrollTop = 0;
const navbar = document.querySelector('.dashboard-nav');

window.addEventListener('scroll', function() {
    let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Jangan buat apa-apa kalau scroll "bounce" kat atas sekali (Safari/Mobile)
    if(scrollTop < 0) return;

    // Logic: Kalau scroll ke bawah DAN dah lepas 50px dari atas
    if (scrollTop > lastScrollTop && scrollTop > 50) {
        // Tambah class untuk sorok
        navbar.classList.add('nav-hidden');
    } else {
        // Buang class untuk tunjuk balik (bila scroll ke atas)
        navbar.classList.remove('nav-hidden');
    }
    
    lastScrollTop = scrollTop;
});
/* =========================================
   FORCE SCROLL TO TOP ON REFRESH
   ========================================= */
if (history.scrollRestoration) {
    history.scrollRestoration = 'manual'; // Halang browser ingat position lama
}
window.scrollTo(0, 0); // Paksa naik atas serta-merta
    </script>
</body>
</html>

