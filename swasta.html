<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Kiraan Gaji — Swasta</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>
<script src="auth.js"></script>

<style>
/* =========================================
   PAGE TRANSITION STYLES
   ========================================= */
body {
    opacity: 0; /* Mula-mula page halimunan */
    transition: opacity 0.5s ease-in-out; /* Tempoh peralihan 0.5 saat */
    pointer-events: none; /* Halang klik masa tengah loading */
}

body.loaded {
    opacity: 1; /* Muncul sepenuhnya */
    pointer-events: auto; /* Boleh klik semula */
}
    /* ===== THEME VARIABLES (Same as Awam) ===== */
    :root {
        --bg-main: #f8fafc; --bg-card: #ffffff;
        --text-primary: #0f172a; --text-secondary: #64748b;
        --brand-blue: #4f46e5; --brand-green: #10b981;
        --border-light: #e2e8f0;
        --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1);
        --shadow-md: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    }
    * { box-sizing: border-box; }
    
    body { 
        margin: 0; padding: 0; font-family: 'Inter', sans-serif; 
        background-color: var(--bg-main); color: var(--text-primary); 
        min-height: 100vh; overflow-x: hidden; padding-bottom: 50px; 
        opacity: 0; transition: opacity 0.4s ease-in-out; 
    }
    body.loaded { opacity: 1; }

 /* =========================================
   FULL PAGE MODERN BACKGROUND
   ========================================= */
.animated-bg {
    position: fixed; /* Guna fixed supaya ia kekal penuh walaupun scroll */
    top: 0; 
    left: 0; 
    width: 100%;
    height: 100%; /* Penuh satu skrin */
    
    /* Warna Moden Mesh Gradient */
    background-color: #f3f4f6;
    background-image: 
        radial-gradient(at 0% 0%, hsla(253,16%,7%,0) 0, transparent 50%), 
        radial-gradient(at 50% 0%, hsla(225,39%,30%,0) 0, transparent 50%), 
        radial-gradient(at 100% 0%, hsla(339,49%,30%,0) 0, transparent 50%);
        
    background-image: 
        radial-gradient(at 40% 20%, hsla(28,100%,74%,1) 0px, transparent 50%),
        radial-gradient(at 80% 0%, hsla(189,100%,56%,1) 0px, transparent 50%),
        radial-gradient(at 0% 50%, hsla(355,100%,93%,1) 0px, transparent 50%),
        radial-gradient(at 80% 50%, hsla(340,100%,76%,1) 0px, transparent 50%),
        radial-gradient(at 0% 100%, hsla(22,100%,77%,1) 0px, transparent 50%),
        radial-gradient(at 80% 100%, hsla(242,100%,70%,1) 0px, transparent 50%),
        radial-gradient(at 0% 0%, hsla(343,100%,76%,1) 0px, transparent 50%);

    /* Blur & Filter untuk efek lembut */
    filter: blur(60px); 
    opacity: 0.6; /* Transparansi supaya tak ganggu teks */
    z-index: -1;
    
    /* Animasi Pergerakan */
    background-size: 150% 150%;
    animation: gradientFull 15s ease infinite alternate;
}

@keyframes gradientFull {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

    /* NAVBAR */
    .dashboard-nav {
        display: flex; justify-content: space-between; align-items: center; padding: 15px 30px;
        background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255,255,255,0.6);
        position: sticky; top: 0; z-index: 100; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        /* TAMBAH 2 BARIS INI UNTUK SMOOTH */
    transition: transform 0.3s ease-in-out;
    will-change: transform;
}

/* TAMBAH CLASS BARU INI (Untuk sorok navbar) */
.dashboard-nav.nav-hidden {
    transform: translateY(-100%); /* Tarik navbar ke atas sampai hilang */
}
    
    .nav-left { display: flex; align-items: center; gap: 12px; }
    .nav-logo { height: 48px; }
    .nav-title { font-weight: 800; font-size: 1.5rem; color: #1e293b; }
    .nav-right { display: flex; gap: 20px; align-items: center; }
    .nav-link { text-decoration: none; color: #475569; font-weight: 600; font-size: 0.9rem; transition: 0.2s; position: relative; }
    .nav-link:hover, .nav-link.active { color: var(--brand-blue); }
    .logout-btn { background: #fee2e2; color: #ef4444; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; cursor: pointer; transition: 0.2s; }

/* =========================================
   MODERN HEADER (RAPAT DENGAN NAV)
   ========================================= */
.custom-header {
    text-align: center;
    padding: 60px 20px 80px; /* Padding ditingkatkan supaya teks tak nampak sempit */
    
    /* === PENTING: Untuk Rapatkan dengan Nav === */
    margin-top: 0 !important;   /* Buang jarak atas */
    margin-bottom: 30px;        /* Jarak dengan content bawah */
    width: 100%;                /* Pastikan lebar penuh */
    
    /* WARNA BACKGROUND MESH */
    background-color: #eef2ff;
    background-image: 
        radial-gradient(at 80% 0%, hsla(189,100%,56%,0.3) 0px, transparent 50%),
        radial-gradient(at 0% 50%, hsla(355,100%,93%,1) 0px, transparent 50%),
        radial-gradient(at 80% 50%, hsla(340,100%,76%,0.1) 0px, transparent 50%),
        radial-gradient(at 0% 100%, hsla(22,100%,77%,0.3) 0px, transparent 50%),
        radial-gradient(at 80% 100%, hsla(242,100%,70%,0.3) 0px, transparent 50%),
        radial-gradient(at 0% 0%, hsla(343,100%,76%,0.3) 0px, transparent 50%);
    
    background-size: 200% 200%;
    animation: meshMove 15s ease-in-out infinite alternate;

    /* BENTUK: Atas rata, Bawah melengkung */
    border-top-left-radius: 0;  /* Rata supaya cantum dengan nav */
    border-top-right-radius: 0; /* Rata supaya cantum dengan nav */
    border-bottom-left-radius: 60px; /* Lengkung cantik di bawah */
    border-bottom-right-radius: 60px;
    
    /* Shadow */
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.05);
    position: relative;
    z-index: 1;
}

/* Style Teks */
.custom-header h1 {
    font-size: 1.8rem;
    margin: 0 0 10px 0;
    font-weight: 800;
    color: #1e293b;
    text-transform: uppercase;
    letter-spacing: -0.5px;
}

.custom-header p {
    font-size: 1rem;
    color: #475569;
    margin: 0;
    font-weight: 600;
}

@keyframes meshMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Tambah ini jika nav anda ada margin */
nav, .navbar {
    margin-bottom: 0 !important;
    box-shadow: none !important; /* Buang shadow nav supaya nampak bersambung */
    border-bottom: none !important;
}

    .main { display: flex; justify-content: center; padding: 0 20px; position: relative; z-index: 2; }
    .panel {
        background: var(--bg-card); border: 1px solid var(--border-light); border-radius: 20px;
        padding: 35px; box-shadow: var(--shadow-md); width: 100%; max-width: 900px; transition: transform 0.3s;
    }

    /* FORM */
    .dropdown-wrapper { margin-bottom: 20px; }
    label { font-weight: 600; font-size: 0.9rem; color: var(--text-secondary); display: block; margin-bottom: 6px; }
    select, input[type="text"], input[type="number"], input[type="date"] {
        width: 100%; padding: 14px; border: 1px solid var(--border-light); border-radius: 10px;
        font-size: 0.95rem; font-family: 'Inter', sans-serif; background: #f8fafc; color: var(--text-primary); outline: none; transition: 0.2s;
    }
    select:focus, input:focus { border-color: var(--brand-green); background: #fff; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1); }
    .row { display: flex; gap: 20px; margin-bottom: 15px; }
    .col { flex: 1; }

    /* BUTTONS */
    .btn {
        width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: 700; cursor: pointer;
        background: var(--brand-green); color: white; margin-top: 15px; font-size: 1rem; transition: 0.2s;
        box-shadow: 0 4px 6px rgba(16, 185, 129, 0.2);
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 15px rgba(16, 185, 129, 0.3); background: #059669; }
    .btn.secondary { background: white; color: var(--text-secondary); border: 2px solid var(--border-light); box-shadow: none; }
    .btn.secondary:hover { background: #f1f5f9; color: var(--text-primary); }
    .btn.print { background: var(--brand-blue); color: white; margin-top: 0; box-shadow: 0 4px 6px rgba(79, 70, 229, 0.2); }
    .action-buttons { display: flex; gap: 10px; margin-top: 15px; }

    /* NAV TOGGLE */
    .navwrap { display: flex; justify-content: center; margin-bottom: 25px; position: relative; z-index: 2; }
    .nav { display: flex; gap: 15px; background: rgba(255,255,255,0.6); padding: 5px; border-radius: 50px; backdrop-filter: blur(10px); box-shadow: var(--shadow-sm); }
    .nav a { text-decoration: none; }
    .circle { padding: 10px 30px; border-radius: 30px; font-weight: 700; font-size: 0.9rem; transition: 0.3s; cursor: pointer; }
    .circle.active { background: var(--brand-green); color: white; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); }
    .circle.inactive { color: var(--text-secondary); }
    .circle.inactive:hover { background: rgba(255,255,255,0.8); color: var(--brand-green); }

    /* EXPERIENCE BOX */
    .exp-item { background: #f1f5f9; border: 1px solid #e2e8f0; padding: 20px; border-radius: 12px; margin-bottom: 15px; position: relative; }
    .remove-exp { position: absolute; top: 15px; right: 15px; color: #ef4444; font-size: 0.8rem; cursor: pointer; font-weight: 800; border: 1px solid #ef4444; padding: 2px 8px; border-radius: 6px; }
    
    /* POPUPS & RESULTS */
    .info-box { background: #f0fdf4; border-left: 4px solid var(--brand-green); padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem; line-height: 1.6; color: #166534; }
    
/* TOOLS */
    /* Grouping asal dikekalkan supaya saiz & bentuk sama */
    .petunjuk-btn, #goTopBtn { 
        position: fixed; width: 50px; height: 50px; border-radius: 50%; border: none; 
        cursor: pointer; box-shadow: var(--shadow-md); z-index: 99; 
        font-weight: bold; transition: 0.2s; color: white; 
    }

    /* Petunjuk button (tak kacau) */
    .petunjuk-btn { bottom: 30px; left: 30px; background: var(--brand-blue); font-size: 24px; }

    /* === UPDATED GO TOP BUTTON (CENTER ARROW) === */
    #goTopBtn { 
        bottom: 30px; 
        right: 30px; 
        background: var(--text-primary); 
        font-size: 24px; /* Saiz arrow besar sikit */
        display: none; 
        
        /* Tambah 3 baris ini untuk paksa center */
        align-items: center;
        justify-content: center;
        padding-bottom: 4px; /* Naikkan arrow sikit ke atas visual center */
    }

    /* PENTING: Ini paksa dia kekal flex (center) walaupun JS set display:block */
    #goTopBtn[style*="display: block"], 
    #goTopBtn[style*="display:block"] {
        display: flex !important;
    }

    #goTopBtn:hover { background: var(--brand-blue); transform: translateY(-3px); }
    
/* PETUNJUK POPUP (Smooth Animation) */
.petunjuk-popup {
    /* State Asal (Sembunyi) */
    position: fixed;
    bottom: 90px;
    left: 30px;
    width: 300px;
    background: white;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    border: 1px solid #e2e8f0;
    z-index: 200;
    
    /* Animasi */
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* State Aktif (Muncul) */
.petunjuk-popup.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* Button Petunjuk */
.petunjuk-btn {
    position: fixed;
    bottom: 30px;
    left: 30px;
    width: 50px;
    height: 50px;
    background: #16a34a;
    color: white;
    border: none;
    border-radius: 50%;
    font-weight: bold;
    font-size: 24px;
    box-shadow: 0 4px 15px rgba(37,99,235,0.3);
    cursor: pointer;
    z-index: 199;
    transition: transform 0.2s;
}
.petunjuk-btn:hover { transform: scale(1.1); }

    /* Result Animation & Table */
    .result-box { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; padding: 25px; border-radius: 12px; margin-top: 25px; animation: slideUp 0.6s ease-out; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    
    .breakdown-table { width: 100%; margin-bottom: 15px; font-size: 0.9rem; border-collapse: collapse; }
    .breakdown-table td { padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
    .breakdown-table td:last-child { text-align: right; font-weight: 600; }

    @media (max-width: 768px) {
        .dashboard-nav { padding: 15px; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .nav-right { gap: 15px; font-size: 0.85rem; }
        .nav-title { font-weight: 800; font-size: 1.1rem; color: #1e293b; }
        .row { flex-direction: column; gap: 10px; } 
        .panel { padding: 20px; }
        .custom-header h1 { font-size: 1.3rem; }
        .btn { padding: 12px; }
        .petunjuk-btn { left: 20px; bottom: 20px; }
        #goTopBtn { right: 20px; bottom: 20px; }
    }

/* === TOOLTIP STYLES (Tambah ini) === */

/* Pastikan elemen induk ada position relative */
.nav-link, .logout-btn {
    position: relative;
}

/* Kotak Teks Tooltip */
[data-tooltip]:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    margin-top: 10px;
    padding: 6px 10px;
    background-color: #1e293b; /* Warna latar gelap */
    color: #fff;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 6px;
    white-space: nowrap;
    opacity: 0;
    animation: tooltipFade 0.3s forwards;
    pointer-events: none;
    z-index: 200;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

/* Anak Panah Kecil (Segitiga) di atas tooltip */
[data-tooltip]:hover::before {
    content: '';
    position: absolute;
    top: 100%; 
    left: 50%;
    transform: translateX(-50%);
    margin-top: 5px;
    border-width: 5px;
    border-style: solid;
    border-color: transparent transparent #1e293b transparent; /* Warna sama dengan background tooltip */
    opacity: 0;
    animation: tooltipFade 0.3s forwards;
    pointer-events: none;
}

/* Animasi Muncul */
@keyframes tooltipFade { 
    to { opacity: 1; margin-top: 10px; } 
}

/* Sembunyikan tooltip pada Mobile supaya tak semak */
@media (max-width: 768px) {
    [data-tooltip]:hover::after, [data-tooltip]:hover::before { display: none; }
}
/* ===== CSS NAVIGASI HYBRID ===== */

.dashboard-nav {
    display: flex; justify-content: space-between; align-items: center; 
    padding: 15px 30px;
    background: rgba(255, 255, 255, 0.95); 
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(255,255,255,0.6); 
    position: sticky; top: 0; z-index: 100;
    margin-bottom: 0;
    height: 70px; /* Tinggi Tetap */
}

/* --- DESKTOP VIEW (Title Sebelah Logo) --- */
.nav-left { 
    display: flex; 
    align-items: center; 
    gap: 15px; /* Jarak antara logo dan title */
}

.nav-logo { height: 48px; }

.nav-title { 
    font-weight: 800; 
    font-size: 1.5rem; 
    color: #1e293b; 
    /* Desktop: Jangan kacau position, biar dia duduk sebelah logo */
    position: static; 
    transform: none;
}

/* Menu Desktop */
.nav-right { display: flex; gap: 20px; align-items: center; }
.nav-link { text-decoration: none; color: #475569; font-weight: 600; font-size: 0.9rem; transition: 0.2s; }
.nav-link:hover, .nav-link.active { color: var(--brand-blue); }
.logout-btn { background: #fee2e2; color: #ef4444; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; cursor: pointer; }

/* Burger Default Hidden */
.hamburger { display: none; cursor: pointer; flex-direction: column; gap: 5px; z-index: 50; }
.hamburger span { width: 25px; height: 3px; background-color: #0f172a; border-radius: 2px; transition: 0.3s; }


/* --- MOBILE RESPONSIVE (Title Jadi Center Sini) --- */
@media (max-width: 768px) {
    .dashboard-nav { padding: 0 20px; } /* Kurangkan padding tepi */

    /* 1. Tunjuk Burger */
    .hamburger { display: flex; }

    /* 2. MAGIC: Title Lari ke Tengah */
    .nav-title {
        position: absolute; /* Cabut dari .nav-left */
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%); /* Center betul-betul */
        
        font-size: 0.95rem; /* Kecilkan sikit */
        width: 60%; /* Hadkan lebar supaya tak langgar logo/burger */
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        z-index: 10;
    }

    /* 3. Menu Dropdown */
    .nav-right {
        position: absolute;
        top: 70px;
        left: 0;
        width: 100%;
        background: white;
        border-bottom: 1px solid #e2e8f0;
        box-shadow: 0 10px 15px rgba(0,0,0,0.05);
        
        display: flex; flex-direction: column; align-items: center;
        max-height: 0; opacity: 0; overflow: hidden;
        transition: all 0.4s ease-in-out;
        padding: 0; gap: 0;
    }

    .nav-right.active {
        max-height: 400px;
        opacity: 1;
        padding: 20px 0;
        gap: 15px;
    }

    .nav-link { width: 100%; padding: 12px; display: block; text-align: center; }
    
    /* Burger Animation */
    .nav-right.active ~ .hamburger span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
    .nav-right.active ~ .hamburger span:nth-child(2) { opacity: 0; }
    .nav-right.active ~ .hamburger span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
}
    .warning-box { margin-top: 20px; background: #fffbeb; border: 1px solid #fcd34d; color: #92400e; padding: 12px; border-radius: 8px; font-size: 0.85rem; line-height: 1.5; display: flex; gap: 10px; align-items: flex-start; }
    .warning-icon { font-size: 1.2rem; }
/* Style untuk kotak hasil kiraan tempoh */
.result-box-highlight {
    background-color: rgba(59, 130, 246, 0.1); /* Biru cair */
    border-left: 5px solid #3b82f6; /* Garis tepi biru */
    padding: 15px;
    margin-top: 10px;
    border-radius: 8px;
    color: #1e293b;
    font-weight: 600;
    font-family: 'Inter', monospace;
    font-size: 0.95rem;
}

.result-box-highlight span {
    font-weight: 800;
}
/* =========================================
   DESIGN PENGALAMAN "PREMIUM"
   ========================================= */

/* Container Utama */
.exp-card {
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    position: relative;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    animation: slideDown 0.3s ease-out; /* Animasi muncul */
}

/* Effect bila mouse lalu (Hover) */
.exp-card:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    border-color: var(--brand-blue);
    transform: translateY(-2px);
}

/* Header (Tajuk & Butang Delete) */
.exp-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px dashed var(--border-light);
}

.exp-title {
    font-weight: 700;
    color: var(--brand-blue);
    font-size: 0.95rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Butang Delete (Style Sampah) */
.btn-trash {
    background: #fee2e2;
    color: #ef4444;
    border: none;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: 0.2s;
    font-weight: bold;
}
.btn-trash:hover {
    background: #ef4444;
    color: white;
    transform: rotate(90deg); /* Pusing bila hover */
}

/* Result Bar (Tempat keluar kiraan hari) */
.exp-status {
    margin-top: 15px;
    padding: 12px 15px;
    background: #f8fafc; /* Kelabu cair asal */
    border-radius: 8px;
    border-left: 4px solid #cbd5e1;
    font-size: 0.9rem;
    color: #64748b;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s;
}

/* Bila Tarikh Valid (Hijau) */
.exp-status.valid {
    background: #f0fdf4;
    color: #166534;
    border-left-color: #16a34a;
    box-shadow: 0 2px 5px rgba(22, 163, 74, 0.1);
}

/* Bila Error (Merah) */
.exp-status.error {
    background: #fef2f2;
    color: #b91c1c;
    border-left-color: #ef4444;
}

/* Highlight Nombor */
.highlight-num {
    font-weight: 800;
    font-size: 1.1rem;
    background: rgba(255,255,255,0.5);
    padding: 2px 6px;
    border-radius: 4px;
}

/* Animasi Muncul */
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}
.btn-add-pill {
    background-color: rgba(59, 130, 246, 0.1); /* Biru cair sangat */
    color: var(--brand-blue);
    border: 1px solid transparent;
    padding: 8px 16px;
    border-radius: 50px; /* Bulat habis */
    font-size: 0.85rem;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
}

.btn-add-pill:hover {
    background-color: var(--brand-blue);
    color: white;
    box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
    transform: scale(1.05);
}
</style>
</head>
<body data-kiraan="swasta">

    <div class="animated-bg"></div>

<nav class="dashboard-nav">
    
    <div class="nav-left">
        <img src="image/HASA.png" class="nav-logo" alt="Logo">
        <span class="nav-title">SISTEM KIRAAN GAJI</span>
    </div>
    
    <div class="hamburger" id="hamburgerBtn">
        <span></span><span></span><span></span>
    </div>

    <div class="nav-right" id="navMenu">
        <a href="dashboard.html" class="nav-link" data-tooltip="Paparan Utama">Dashboard</a>
        <a href="contohawam.html" class="nav-link" data-tooltip="Kiraan Sektor Kerajaan">Kiraan Awam</a>
        <a href="swasta.html" class="nav-link active" data-tooltip="Kiraan Sektor Korporat">Kiraan Swasta</a>
        <button id="logoutBtn" class="logout-btn" data-tooltip="Keluar Sistem">Logout</button>
    </div>
</nav>

    <header class="custom-header">
        <h1>KIRAAN GAJI SWASTA</h1>
        <p>Lantikan Baru / Belum Disahkan</p>
    </header>

    <div class="navwrap">
        <div class="nav">
            <a href="contohawam.html" class="transition-link"><div class="circle inactive">AWAM</div></a>
            <a href="swasta.html" class="transition-link"><div class="circle active">SWASTA</div></a>
        </div>
    </div>

    <button id="petunjukBtn" class="petunjuk-btn">?</button>
    <button id="goTopBtn" title="Go to Top">↑</button>

    <div id="petunjukPopup" class="petunjuk-popup">
        <h4 style="color:var(--brand-green); margin-top:0;">PETUNJUK ELAUN</h4>
        <table>
            <tr><td><strong>ITKA</strong></td><td>Imbuhan Tetap Khidmat Awam</td></tr>
            <tr><td><strong>ITK</strong></td><td>Imbuhan Tetap Keraian</td></tr>
            <tr><td><strong>ITP</strong></td><td>Imbuhan Tetap Perumahan</td></tr>
            <tr><td><strong>BISH</strong></td><td>Bantuan Sara Hidup</td></tr>
            <tr><td><strong>BIW</strong></td><td>Bayaran Insentif Wilayah</td></tr>
        </table>
    </div>

    <div class="main">
        <div class="panel">
            <div class="info-box">
                <strong>Panduan:</strong> Isi Jawatan dan Wilayah. Tambah pengalaman kerja (sertakan nama organisasi). Sistem mengira tahun pengalaman secara automatik.
            </div>

            <div class="dropdown-wrapper">
                <label>Pilih Jawatan Swasta</label>
                <select id="jawatan_swasta">
                    <option value="" disabled selected>-- Sila Pilih --</option>
                    <option value="Juruteknik Perubatan U1">JURUTEKNIK PERUBATAN U1</option>
                    <option value="Pembantu Perawatan Kesihatan U1">PEMBANTU PERAWATAN KESIHATAN U1</option>
                    <option value="Pembantu Pembedahan Pergigian U1">PEMBANTU PEMBEDAHAN PERGIGIAN U1</option>
                    <option value="Penolong Pegawai Kesihatan Persekitaran U5">PENOLONG PEGAWAI KESIHATAN PERSEKITARAN U5</option>
                    <option value="Juruteknologi Makmal Perubatan U5">JURUTEKNOLOGI MAKMAL PERUBATAN U5</option>
                    <option value="Penolong Pegawai Farmasi U5">PENOLONG PEGAWAI FARMASI U5</option>
                    <option value="Juru X-Ray U5">JURU X-RAY U5</option>
                    <option value="Jurupulih Perubatan U5 - Diploma Fisioterapi">JURUPULIH PERUBATAN U5 - FISIOTERAPI</option>
                    <option value="Jurupulih Perubatan U5 - DLKM">JURUPULIH PERUBATAN U5 - DLKM</option>
                    <option value="Jurupulih Perubatan U5 - DKM">JURUPULIH PERUBATAN U5 - DKM</option>
                    <option value="Penolong Pegawai Perubatan U5">PENOLONG PEGAWAI PERUBATAN U5</option>
                    <option value="Jururawat U5">JURURAWAT U5</option>
                    <option value="Penolong Pegawai Perubatan U9">PENOLONG PEGAWAI PERUBATAN U9</option>
                    <option value="Pegawai kesihatan Persekitaran U9">PEGAWAI KESIHATAN PERSEKITARAN U9</option>
                    <option value="Pegawai Pemulihan Perubatan U9">PEGAWAI PEMULIHAN PERUBATAN U9</option>
                    <option value="Pegawai Dietetik U9">PEGAWAI DIETETIK U9</option>
                    <option value="Pegawai Optometri U9">PEGAWAI OPTOMETRI U9</option>
                    <option value="Juru X-Ray U9">JURU X-RAY U9</option>
                    <option value="Jururawat U9">JURURAWAT U9</option>
                    <option value="Pegawai Farmasi U9">PEGAWAI FARMASI U9</option>
                    <option value="Pegawai Pergigian UG9">PEGAWAI PERGIGIAN UG9</option>
                    <option value="Pegawai Perubatan UD10">PEGAWAI PERUBATAN UD10</option>
                    <option value="Pegawai Perubatan UD12">PEGAWAI PERUBATAN UD12</option>
                    <option value="Pegawai Perubatan UD13">PEGAWAI PERUBATAN UD13</option>
                    <option value="Pegawai Perubatan UD14">PEGAWAI PERUBATAN UD14</option>
                    <option value="Pegawai Perubatan Pakar UD13">PEGAWAI PERUBATAN PAKAR UD13</option>
                    <option value="Pegawai Perubatan Pakar UD14">PEGAWAI PERUBATAN PAKAR UD14</option>
                    <option value="Pegawai Perubatan Pakar UD15">PEGAWAI PERUBATAN PAKAR UD15</option>
                </select>
            </div>

            <div class="dropdown-wrapper">
                <label>Wilayah Asal Pemohon</label>
                <select id="wilayahPemohon">
                    <option value="" disabled selected>-- Pilih --</option>
                    <option value="Semenanjung">Semenanjung</option>
                    <option value="Sabah">Sabah</option>
                    <option value="Sarawak">Sarawak</option>
                    <option value="Labuan">Labuan</option>
                </select>
            </div>

            <div class="row">
                <div class="col"><label>Kategori</label><input type="text" id="kategoriJawatan" readonly style="background:#f1f5f9; color:#64748b;"></div>
                <div class="col"><label>Gaji Minimum (RM)</label><input type="text" id="gajiMinimum" readonly></div>
            </div>

            <div style="margin-top:25px; border-bottom:1px solid #e2e8f0; margin-bottom:15px; padding-bottom:5px; font-weight:700; color:#475569;">
                PERINCIAN ELAUN
            </div>
            <div class="row">
                <div class="col"><label>ITKA</label><input type="number" id="elaun_itka_sw" readonly></div>
                <div class="col"><label>ITK</label><input type="number" id="elaun_itk_sw" readonly></div>
                <div class="col"><label>ITP</label><input type="number" id="elaun_itp_sw" readonly></div>
            </div>
            <div class="row">
                <div class="col"><label>BISH (Semenanjung)</label><input type="number" id="elaun_bish_sw" readonly></div>
                <div class="col"><label>BIW (Sabah/Sarawak/Labuan)</label><input type="number" id="elaun_biw_sw" readonly></div>
            </div>
            <div class="row">
                <div class="col"><label>BIPK</label><input type="number" id="elaun_bipk_sw" readonly></div>
                <div class="col"><label>BIP</label><input type="number" id="elaun_bip_sw" readonly></div>
            </div>

<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
    <h3>Senarai Pengalaman Kerja</h3>
    <button type="button" class="btn-add-pill" onclick="addExperienceRow()">
        <span style="font-size:1.2em">+</span> Tambah
    </button>
</div>
<div class="form-section">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
    </div>

    <div id="experienceContainer"></div>
</div>

            <button class="btn" onclick="computeSwasta()" style="margin-top:20px;">KIRA GAJI SWASTA</button>

            <div id="resultContentSwasta"></div>

            <div class="action-buttons">
                <button class="btn secondary" onclick="resetSwastaForm()">RESET</button>
                <button class="btn print" id="printBtn" onclick="printSwastaResult()" style="display:none;">CETAK SLIP</button>
            </div>
        </div>
    </div>

<script>
    /* =========================================
       1. PAGE UI LOGIC (TRANSITION & NAV)
       ========================================= */
    document.addEventListener("DOMContentLoaded", () => {
        // Fade In Effect
        setTimeout(() => document.body.classList.add("loaded"), 10);
        
        // Tambah 1 kotak pengalaman siap-siap
        addExperienceRow(); 

        // Hamburger Menu Logic
        const navBtn = document.getElementById('hamburgerBtn');
        const navMenu = document.getElementById('navMenu');
        if(navBtn && navMenu) navBtn.onclick = () => navMenu.classList.toggle('active');

// LOGIC PETUNJUK (SMOOTH ANIMATION)
        const pBtn = document.getElementById('petunjukBtn');
        const pPop = document.getElementById('petunjukPopup');
        
        if(pBtn && pPop) {
            // Pastikan tiada style 'display:none' yang kacau CSS
            pPop.style.display = ''; 

            // Toggle Class 'active' bila tekan butang ?
            pBtn.onclick = (e) => {
                e.stopPropagation();
                pPop.classList.toggle('active');
            };

            // Tutup bila klik di luar kotak
            window.addEventListener('click', (e) => {
                if (pPop.classList.contains('active') && !pPop.contains(e.target) && e.target !== pBtn) {
                    pPop.classList.remove('active');
                }
            });
            
            // Tutup bila tekan butang "Tutup" dalam popup
            const closeBtn = pPop.querySelector('button');
            if(closeBtn) {
                closeBtn.onclick = (e) => {
                    e.stopPropagation();
                    pPop.classList.remove('active');
                }
            }
        }

        // Go Top Button Logic
        const goTop = document.getElementById('goTopBtn');
        const navbar = document.querySelector('.dashboard-nav');
        let lastScrollTop = 0;

        window.addEventListener('scroll', function() {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if(scrollTop < 0) return;
            if (scrollTop > lastScrollTop && scrollTop > 50) navbar?.classList.add('nav-hidden');
            else navbar?.classList.remove('nav-hidden');
            lastScrollTop = scrollTop;
            if(goTop) goTop.style.display = scrollTop > 300 ? "flex" : "none";
        });

        if(goTop) goTop.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
    });
        // 4. Logout Logic
        document.getElementById('logoutBtn')?.addEventListener('click', async () => {
            const notif = document.createElement('div');
            notif.textContent = 'Sedang Log Keluar...';
            notif.style.cssText = "position:fixed; top:20px; left:50%; transform:translateX(-50%); background-color: var(--brand-blue); color:white; padding:12px 24px; border-radius:30px; font-weight:600; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index:9999; opacity:0; transition:all 0.3s ease;";
            document.body.appendChild(notif);
            setTimeout(() => { notif.style.opacity = 1; notif.style.top = '30px'; }, 10);
            setTimeout(async () => {
                await firebase.auth().signOut();
                location.href = 'login.html';
            }, 1200);
        });
    if (history.scrollRestoration) history.scrollRestoration = 'manual';
    window.scrollTo(0, 0);

    /* =========================================
       HELPER: FORMAT DUIT (RM 1,234.56)
       ========================================= */
    function formatMoney(amount) {
        return parseFloat(amount).toLocaleString('en-US', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        });
    }

    /* =========================================
       2. DATA JAWATAN SWASTA (LENGKAP)
       ========================================= */
    const jawatanSwasta = {
        "Juruteknik Perubatan U1": { kategori: "Pelaksana (KUMP. C)", gajiMin: 1500, KGT: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Pembantu Perawatan Kesihatan U1": { kategori: "Pelaksana (KUMP. C)", gajiMin: 1500, KGT: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Pembantu Pembedahan Pergigian U1": { kategori: "Pelaksana (KUMP. C)", gajiMin: 1561, KGT: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Penolong Pegawai Kesihatan Persekitaran U5": { kategori: "Pelaksana (KUMP. C)", gajiMin: 1500, KGT: 100, elaun: { "Semenanjung": { ITKA:115, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:115, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Juruteknologi Makmal Perubatan U5": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Penolong Pegawai Farmasi U5": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Juru X-Ray U5": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Jurupulih Perubatan U5 - Diploma Fisioterapi": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Jurupulih Perubatan U5 - DLKM": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1812, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Jurupulih Perubatan U5 - DKM": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1731, KGT: 145, elaun: { "Semenanjung": { ITKA:1, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:0, BIP:0 } } },
        "Penolong Pegawai Perubatan U5": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:150, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 } } },
        "Jururawat U5": { kategori: "Pelaksana (KUMP. B)", gajiMin: 1974, KGT: 145, elaun: { "Semenanjung": { ITKA:160, ITK:0, ITP:300, BISH:300, BIW:0, BIPK:150, BIP:0 }, "Sabah": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 }, "Sarawak": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 }, "Labuan": { ITKA:160, ITK:0, ITP:300, BISH:0, BIW:300, BIPK:150, BIP:0 } } },
        "Penolong Pegawai Perubatan U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:165, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 } } },
        "Pegawai Kesihatan Persekitaran U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 } } },
        "Pegawai Pemulihan Perubatan U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 } } },
        "Pegawai Dietetik U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 } } },
        "Pegawai Optometri U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 } } },
        "Juru X-Ray U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:0, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:0, BIP:0 } } },
        "Jururawat U9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2580, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:165, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:165, BIP:0 } } },
        "Pegawai Farmasi UF9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 2910, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Pergigian UG9": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 3020, KGT: 225, elaun: { "Semenanjung": { ITKA:300, ITK:0, ITP:300, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:300, ITK:0, ITP:300, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Perubatan UD10": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 3840, KGT: 250, elaun: { "Semenanjung": { ITKA:0, ITK:400, ITP:400, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:0, ITK:400, ITP:400, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:0, ITK:400, ITP:400, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:0, ITK:400, ITP:400, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Perubatan UD12": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 5530, KGT: 270, elaun: { "Semenanjung": { ITKA:0, ITK:550, ITP:700, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:0, ITK:550, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:0, ITK:550, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:0, ITK:550, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Perubatan UD13": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 6210, KGT: 290, elaun: { "Semenanjung": { ITKA:0, ITK:600, ITP:700, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Perubatan UD14": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 6560, KGT: 320, elaun: { "Semenanjung": { ITKA:0, ITK:800, ITP:900, BISH:250, BIW:0, BIPK:750, BIP:0 }, "Sabah": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Sarawak": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:0 }, "Labuan": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:0 } } },
        "Pegawai Perubatan Pakar UD13": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 6210, KGT: 290, elaun: { "Semenanjung": { ITKA:0, ITK:600, ITP:700, BISH:250, BIW:0, BIPK:750, BIP:2500 }, "Sabah": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:2500 }, "Sarawak": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:2500 }, "Labuan": { ITKA:0, ITK:600, ITP:700, BISH:0, BIW:360, BIPK:750, BIP:2500 } } },
        "Pegawai Perubatan Pakar UD14": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 6560, KGT: 320, elaun: { "Semenanjung": { ITKA:0, ITK:800, ITP:900, BISH:250, BIW:0, BIPK:750, BIP:2800 }, "Sabah": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:2800 }, "Sarawak": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:2800 }, "Labuan": { ITKA:0, ITK:800, ITP:900, BISH:0, BIW:360, BIPK:750, BIP:2800 } } },
        "Pegawai Perubatan Pakar UD15": { kategori: "PENGURUSAN & PROFESIONAL", gajiMin: 7030, KGT: 400, elaun: { "Semenanjung": { ITKA:0, ITK:2100, ITP:1100, BISH:250, BIW:0, BIPK:750, BIP:3000 }, "Sabah": { ITKA:0, ITK:2100, ITP:1100, BISH:0, BIW:360, BIPK:750, BIP:3000 }, "Sarawak": { ITKA:0, ITK:2100, ITP:1100, BISH:0, BIW:360, BIPK:750, BIP:3000 }, "Labuan": { ITKA:0, ITK:2100, ITP:1100, BISH:0, BIW:360, BIPK:750, BIP:3000 } } }
    };

    /* =========================================
       3. DOM ELEMENTS
       ========================================= */
    const els = {
        jawatan: document.getElementById('jawatan_swasta'),
        wilayah: document.getElementById('wilayahPemohon'),
        kategori: document.getElementById('kategoriJawatan'),
        gajiMin: document.getElementById('gajiMinimum'),
        expContainer: document.getElementById('experienceContainer'),
        
        itka: document.getElementById('elaun_itka_sw'),
        itk: document.getElementById('elaun_itk_sw'),
        itp: document.getElementById('elaun_itp_sw'),
        bish: document.getElementById('elaun_bish_sw'),
        biw: document.getElementById('elaun_biw_sw'),
        bipk: document.getElementById('elaun_bipk_sw'),
        bip: document.getElementById('elaun_bip_sw'),
        
        result: document.getElementById('resultContentSwasta'),
        printBtn: document.getElementById('printBtn')
    };

    let calculatedData = {};

    if(els.jawatan && els.wilayah) {
        els.jawatan.addEventListener('change', updateSwastaInfo);
        els.wilayah.addEventListener('change', updateSwastaInfo);
    }

    function updateSwastaInfo() {
        const j = els.jawatan.value;
        const w = els.wilayah.value;
        if(!j || !w) return;

        const data = jawatanSwasta[j];
        const elaun = data.elaun[w];

        if(els.kategori) els.kategori.value = data.kategori;
        if(els.gajiMin) els.gajiMin.value = data.gajiMin;

        if(els.itka) els.itka.value = elaun.ITKA;
        if(els.itk) els.itk.value = elaun.ITK;
        if(els.itp) els.itp.value = elaun.ITP;
        if(els.bish) els.bish.value = elaun.BISH;
        if(els.biw) els.biw.value = elaun.BIW;
        if(els.bipk) els.bipk.value = elaun.BIPK;
        if(els.bip) els.bip.value = elaun.BIP;
    }

    /* =========================================
       4. EXPERIENCE LOGIC
       ========================================= */
    function addExperienceRow() {
        const container = document.getElementById('experienceContainer');
        const index = container.querySelectorAll('.exp-card').length + 1;

        const div = document.createElement('div');
        div.className = 'exp-item exp-card'; 

        div.innerHTML = `
            <div class="exp-header">
                <span class="exp-title"># Pengalaman ${index}</span>
                <button class="btn-trash" onclick="this.closest('.exp-item').remove(); reindexRows();" title="Hapus">✕</button>
            </div>

            <div style="margin-bottom:15px;">
                <label style="font-size:0.85rem; font-weight:600; color:var(--text-secondary); margin-bottom:5px; display:block;">Nama Majikan / Organisasi</label>
                <input type="text" class="exp-org" placeholder="Contoh: Klinik Kesihatan..." 
                       style="width:100%; padding:12px; border:1px solid var(--border-light); border-radius:8px; background:var(--bg-input); color:var(--text-primary); transition:0.3s;">
            </div>

            <div class="grid-2" style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div>
                    <label style="font-size:0.85rem; font-weight:600; color:var(--text-secondary); margin-bottom:5px; display:block;">Tarikh Mula</label>
                    <input type="date" class="exp-start" onchange="updateRowStats(this)" 
                           style="width:100%; padding:10px; border:1px solid var(--border-light); border-radius:8px; background:var(--bg-input); color:var(--text-primary);">
                </div>
                <div>
                    <label style="font-size:0.85rem; font-weight:600; color:var(--text-secondary); margin-bottom:5px; display:block;">Tarikh Tamat</label>
                    <input type="date" class="exp-end" onchange="updateRowStats(this)" 
                           style="width:100%; padding:10px; border:1px solid var(--border-light); border-radius:8px; background:var(--bg-input); color:var(--text-primary);">
                </div>
            </div>

            <div class="row-stats exp-status">
                <span style="font-size:1.2rem">ℹ️</span> 
                <span>Sila masukkan tarikh mula & tamat.</span>
            </div>
        `;
        container.appendChild(div);
    }

    function updateRowStats(el) {
        const row = el.closest('.exp-item');
        const s = row.querySelector('.exp-start').value;
        const e = row.querySelector('.exp-end').value;
        const stats = row.querySelector('.row-stats');

        if(s && e) {
            const d1 = new Date(s);
            const d2 = new Date(e);
            
            if(d2 >= d1) {
                const diffTime = Math.abs(d2 - d1);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                const years = (diffDays / 365.25).toFixed(2);
                const eligible = Math.floor(diffDays / 365.25);

                stats.className = "row-stats exp-status valid";
                stats.innerHTML = `
                    <div style="display:flex; flex-direction:column; width:100%;">
                        <div style="display:flex; justify-content:space-between; border-bottom:1px solid rgba(0,0,0,0.05); padding-bottom:5px; margin-bottom:5px;">
                            <span>Tempoh: <strong>${diffDays} Hari</strong></span>
                            <span>Tepat: <strong>${years} Thn</strong></span>
                        </div>
                        <div style="font-size:1rem; color:#15803d;">
                            LAYAK DIAMBIL KIRA: <span class="highlight-num">${eligible} TAHUN</span>
                        </div>
                    </div>
                `;
            } else {
                stats.className = "row-stats exp-status error";
                stats.innerHTML = `<span>⚠️ Harap Maaf, <strong>Tarikh Tamat</strong> mesti selepas Tarikh Mula.</span>`;
            }
        }
    }

    function reindexRows() {
        const rows = document.querySelectorAll('.exp-card');
        rows.forEach((row, index) => {
            row.querySelector('.exp-title').innerText = `# Pengalaman ${index + 1}`;
        });
    }
/* =========================================
   FUNGSI RESET PENUH (Scroll + Clear Form + Hilang Result)
   ========================================= */
function resetSwastaForm() {
    // 1. Naik ke atas (Smooth Scroll)
    window.scrollTo({ top: 0, behavior: 'smooth' });

    // 2. Reset Borang HTML Asas
    const form = document.getElementById('swastaForm');
    if (form) form.reset();

    // 3. PAKSA Reset Dropdown & Input Readonly
    const gradeSelect = document.getElementById('gradeSelect');
    if (gradeSelect) gradeSelect.selectedIndex = 0; // Balik ke "Sila Pilih"

    const wilayahSelect = document.getElementById('wilayahPemohon');
    if (wilayahSelect) wilayahSelect.selectedIndex = 0;

    // Kosongkan nilai Gaji & Input Tersembunyi
    const idsToClear = ['gajiMinimum', 'jawatan_swasta', 'kategoriJawatan'];
    idsToClear.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = "";
    });

    // 4. Reset Kotak Pengalaman (Buang semua, tinggal 1 kosong)
    const container = document.getElementById('experienceContainer');
    if (container) {
        container.innerHTML = ''; 
        addExperienceRow(); // Tambah balik satu kotak kosong
    }

    // 5. HILANGKAN RESULT (Ini yang anda mahu)
    const resultDiv = document.getElementById('resultContentSwasta');
    if (resultDiv) {
        resultDiv.innerHTML = ""; // Padam semua isi dalam kotak result
        // Jika kotak result ada border/padding asal dalam CSS, boleh tambah:
        // resultDiv.style.display = 'none'; 
    }
    
    // 6. Sorokkan Butang Print
    const printBtn = document.getElementById('printBtn');
    if (printBtn) printBtn.style.display = 'none';
}
    /* =========================================
       5. MAIN CALCULATION (DESIGN BARU - ALA AWAM)
       ========================================= */
    function computeSwasta() {
        if(!els.jawatan.value) { alert("Sila pilih jawatan."); return; }

        const data = jawatanSwasta[els.jawatan.value];
        const rows = document.querySelectorAll('.exp-item');
        
        let totalFloorYears = 0;
        let expDetails = [];
        let expRowsHTML = "";

        rows.forEach((row, index) => {
            const org = row.querySelector('.exp-org').value || `Organisasi ${index + 1}`;
            const s = row.querySelector('.exp-start').value;
            const e = row.querySelector('.exp-end').value;

            if(s && e) {
                const d1 = new Date(s);
                const d2 = new Date(e);

                if(d2 >= d1) {
                    const diffTime = Math.abs(d2 - d1);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
                    const years = diffDays / 365.25;
                    const floorY = Math.floor(years);

                    totalFloorYears += floorY;

                    const fMula = d1.toLocaleDateString('ms-MY');
                    const fTamat = d2.toLocaleDateString('ms-MY');

                    expDetails.push({ org, fMula, fTamat, diffDays, floorY });

                    expRowsHTML += `
                        <div style="border-bottom:1px solid #eee; padding:8px 0;">
                            <strong>${org}</strong><br>
                            <span style="font-size:0.85rem; color:#555;">${fMula} - ${fTamat} (${diffDays} hari)</span><br>
                            <span style="font-size:0.9rem; color:green;">Diambil kira: <strong>${floorY} tahun</strong></span>
                        </div>
                    `;
                }
            }
        });

        const gajiPermulaan = data.gajiMin;
        const KGT = data.KGT;
        const jumlahKGT = totalFloorYears * KGT;
        const gajiDitawar = gajiPermulaan + jumlahKGT;

        const allowances = {
            'ITKA': parseFloat(els.itka.value) || 0,
            'ITK': parseFloat(els.itk.value) || 0,
            'ITP': parseFloat(els.itp.value) || 0,
            'BISH': parseFloat(els.bish.value) || 0,
            'BIW': parseFloat(els.biw.value) || 0,
            'BIPK': parseFloat(els.bipk.value) || 0,
            'BIP': parseFloat(els.bip.value) || 0
        };

        let totalElaun = 0;
        let breakdownHTML = '<table style="width:100%; font-size:0.9rem; margin-top:5px;">';
        for (let key in allowances) {
            if (allowances[key] > 0) {
                totalElaun += allowances[key];
                breakdownHTML += `<tr><td style="color:#555">${key}</td><td style="text-align:right">RM ${formatMoney(allowances[key])}</td></tr>`;
            }
        }
        breakdownHTML += '</table>';

        const grandTotal = gajiDitawar + totalElaun;

        calculatedData = {
            nama: firebase.auth().currentUser ? firebase.auth().currentUser.email : 'Pengguna',
            jawatan: els.jawatan.value,
            kategori: data.kategori,
            gajiMin: gajiPermulaan,
            expDetails: expDetails,
            totalYear: totalFloorYears,
            totalKGT: jumlahKGT,
            gajiBaru: gajiDitawar,
            elaun: totalElaun,
            kasar: grandTotal,
            tarikh: new Date().toLocaleString()
        };

        // --- DESIGN BARU (Macam Awam) ---
        els.result.innerHTML = `
            <div class="result-box">
                <h3 style="margin-top:0; border-bottom:1px solid var(--border-light); padding-bottom:10px; color:var(--brand-green)">
                    Keputusan Swasta
                </h3>
                
                <div style="background:var(--bg-input); padding:10px; border-radius:8px; margin-bottom:15px; border:1px solid var(--border-light);">
                    ${expRowsHTML || '<div style="font-style:italic">Tiada pengalaman dikira.</div>'}
                    <div style="margin-top:10px; padding-top:10px; border-top:2px dashed #ccc; text-align:right;">
                        Jumlah Tahun Layak: <strong style="font-size:1.2rem; color:green;">${totalFloorYears} Tahun</strong>
                    </div>
                </div>

                <table style="width:100%; border-collapse:collapse; margin-bottom:10px;">
                    <tr><td>Gaji Permulaan</td><td style="text-align:right">RM ${formatMoney(gajiPermulaan)}</td></tr>
                    <tr><td>+ KGT (${totalFloorYears} x RM${formatMoney(KGT)})</td><td style="text-align:right">RM ${formatMoney(jumlahKGT)}</td></tr>
                    <tr style="font-weight:bold; background:#f0fdf4;"><td>Gaji Ditawar</td><td style="text-align:right">RM ${formatMoney(gajiDitawar)}</td></tr>
                </table>
                
                <div style="margin:10px 0;">
                    <strong>Elaun:</strong>
                    ${breakdownHTML}
                </div>

                <div style="background: linear-gradient(135deg, #064e3b 0%, #047857 100%); color:white; padding:20px; border-radius:12px; margin-top:20px; text-align:center; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <div style="font-size:0.9rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:5px; opacity:0.9;">
                        Anggaran Gaji Kasar
                    </div>
                    <div style="font-size:2.2rem; font-weight:800; line-height:1.1;">
                        RM ${formatMoney(grandTotal)}
                    </div>
                    <div style="font-size:0.8rem; margin-top:5px; opacity:0.8;">
                        (Gaji Pokok + Elaun)
                    </div>
                </div>
            </div>

            <div style="margin-top:20px; background-color: #fffbeb; border: 1px dashed #d97706; border-left: 5px solid #d97706; padding: 15px; border-radius: 6px; display:flex; align-items:flex-start; gap:12px;">
                <span style="font-size:1.5rem;">⚠️</span>
                <div style="font-size:0.9rem; color:#92400e; line-height:1.5;">
                    <strong>PENAFIAN PENTING:</strong><br>
                    Pengiraan ini adalah <u>simulasi semata-mata</u> untuk tujuan rujukan pantas. Amaun sebenar adalah tertakluk kepada pengesahan Bahagian Sumber Manusia (BSM) & Unit Gaji.
                </div>
            </div>
        `;
        
        els.printBtn.style.display = 'inline-block';
        els.result.scrollIntoView({ behavior: 'smooth', block: 'start' });

        // NOTA: Saya buang saveToFirebase di sini. Ia akan save HANYA bila tekan print.
    }

    /* =========================================
       6. PRINT FUNCTION
       ========================================= */
    function printSwastaResult() {
        const w = window.open('', '', 'width=800,height=600');
        const d = calculatedData;
        
        let rows = d.expDetails.map(e => `
            <tr>
                <td><strong>${e.org}</strong><br><small>${e.fMula} - ${e.fTamat}</small></td>
                <td style="text-align:center">${e.diffDays} hari</td>
                <td style="text-align:center">${e.floorY} tahun</td>
            </tr>
        `).join('');

        w.document.write(`
            <html><head><title>Slip Gaji Swasta</title>
            <style>
                body{ font-family: sans-serif; padding: 20px; position:relative; }
                .watermark {
                    position: fixed; top: 50%; left: 50%;
                    transform: translate(-50%, -50%) rotate(-45deg);
                    font-size: 80px; font-weight: 800; color: rgba(0,0,0,0.05);
                    z-index: -1; pointer-events: none; border: 10px solid rgba(0,0,0,0.05);
                    padding: 20px; text-transform: uppercase; white-space: nowrap;
                }
                .header{ text-align:center; border-bottom:2px solid #000; padding-bottom:10px; margin-bottom:20px; }
                table{ width:100%; border-collapse:collapse; margin-top:10px; margin-bottom:20px; }
                th, td{ border:1px solid #ccc; padding:8px; text-align:left; }
                th{ background:#f0f0f0; }
                .total{ font-size:1.2rem; font-weight:bold; background:#eef2ff; }
                .warning-box {
                    border: 2px dashed #f59e0b; background-color: #fffbeb; color: #92400e;
                    padding: 15px; border-radius: 8px; font-size: 12px; text-align: center; margin-top: 40px;
                }
            </style>
            </head><body>
            
            <div class="watermark">SIMULASI SAHAJA</div>

            <div class="header"><h2>HASA UiTM</h2><p>Sistem Kiraan Gaji - Sektor Swasta</p></div>
            
            <p><strong>Jawatan:</strong> ${d.jawatan}</p>
            <p><strong>Kategori:</strong> ${d.kategori}</p>
            
            <h4>Rekod Pengalaman Kerja</h4>
            <table>
                <tr><th width="50%">Organisasi</th><th>Tempoh</th><th>Layak (Tahun)</th></tr>
                ${rows}
                <tr style="background:#f9fafb"><td colspan="2" style="text-align:right"><strong>Jumlah Layak:</strong></td><td><strong>${d.totalYear} Tahun</strong></td></tr>
            </table>

            <h4>Keputusan Kiraan Gaji</h4>
            <table>
                <tr><th>Perkara</th><th>Amaun (RM)</th></tr>
                <tr><td>Gaji Permulaan</td><td>${formatMoney(d.gajiMin)}</td></tr>
                <tr><td>Kenaikan Gaji Tahunan (KGT)</td><td>${formatMoney(d.totalKGT)}</td></tr>
                <tr><td><strong>Gaji Pokok Baru</strong></td><td><strong>${formatMoney(d.gajiBaru)}</strong></td></tr>
                <tr><td>Jumlah Elaun</td><td>${formatMoney(d.elaun)}</td></tr>
                <tr class="total"><td>JUMLAH PENDAPATAN KASAR</td><td>${formatMoney(d.kasar)}</td></tr>
            </table>

            <div class="warning-box">
                <strong>⚠️ PERHATIAN PENTING</strong><br>
                Dokumen ini adalah <u>simulasi automatik</u>. Ia <strong>BUKAN</strong> slip gaji rasmi.
            </div>
            
            <script>window.print();<\/script>
            </body></html>
        `);
        w.document.close();
        
        // SAVE KE FIREBASE HANYA BILA TEKAN PRINT
        saveToFirebase(calculatedData);
    }

    /* =========================================
       7. FIREBASE INTEGRATION
       ========================================= */
    async function saveToFirebase(data) {
        const user = firebase.auth().currentUser;
        if (user) {
            try {
                await firebase.firestore().collection('printedSlips').add({
                    userId: user.uid,
                    userEmail: user.email,
                    jenis_kiraan: 'Kiraan Swasta',
                    jawatan: data.jawatan,
                    jumlah_kasar: data.kasar,
                    gaji_pokok: data.gajiBaru,
                    pengalaman_tahun: data.totalYear,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                console.log("Data disimpan ke Dashboard.");
            } catch (error) {
                console.error("Firebase Error:", error);
            }
        }
    }
</script>
</body>
</html>
