<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>HASA Dashboard Pro</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="firebase-config.js"></script>
<script src="auth.js"></script>

<style>
/* =========================================
   1. VARIABLES & RESET
   ========================================= */
:root {
    --primary: #4f46e5;       /* Indigo 600 */
    --primary-dark: #4338ca;  /* Indigo 700 */
    --secondary: #8b5cf6;     /* Violet 500 */
    --accent: #06b6d4;        /* Cyan 500 */
    --dark: #0f172a;          /* Slate 900 */
    --text-grey: #64748b;     /* Slate 500 */
    --bg-body: #f8fafc;       /* Slate 50 */
    
    --glass-bg: rgba(255, 255, 255, 0.85);
    --glass-border: 1px solid rgba(255, 255, 255, 0.6);
    --shadow-card: 0 10px 30px -10px rgba(0,0,0,0.06);
    --sidebar-width: 270px;
}

* { box-sizing: border-box; margin: 0; padding: 0; outline: none; }

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--bg-body);
    color: #334155;
    min-height: 100vh;
    overflow-x: hidden;
}

/* =========================================
   2. AMBIENT BACKGROUND
   ========================================= */
.ambient-bg {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
    background: radial-gradient(at 0% 0%, #eef2ff 0px, transparent 50%),
                radial-gradient(at 100% 0%, #f0fdfa 0px, transparent 50%),
                radial-gradient(at 100% 100%, #fdf4ff 0px, transparent 50%);
}

/* =========================================
   3. LAYOUT STRUCTURE
   ========================================= */
.app-container {
    display: grid;
    grid-template-columns: var(--sidebar-width) 1fr;
    min-height: 100vh;
}

/* =========================================
   4. SIDEBAR (GLASSMORPHISM)
   ========================================= */
.sidebar {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    border-right: var(--glass-border);
    padding: 30px 24px;
    display: flex; flex-direction: column;
    position: sticky; top: 0; height: 100vh;
    z-index: 50;
}

.brand {
    display: flex; align-items: center; gap: 12px; margin-bottom: 50px;
    padding-bottom: 20px; border-bottom: 1px solid rgba(0,0,0,0.05);
}
.brand-text { font-weight: 800; font-size: 1.25rem; color: var(--dark); letter-spacing: -0.5px; }

.nav-links { display: flex; flex-direction: column; gap: 8px; flex: 1; }
.nav-item {
    display: flex; align-items: center; gap: 14px;
    padding: 14px 16px; border-radius: 12px;
    text-decoration: none; color: var(--text-grey);
    font-weight: 600; font-size: 0.95rem;
    transition: all 0.2s ease;
}
.nav-item:hover { background: white; color: var(--primary); box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
.nav-item.active {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white; box-shadow: 0 8px 20px -6px rgba(79, 70, 229, 0.4);
}
.nav-icon { width: 22px; font-size: 1.1rem; display: flex; justify-content: center; }

/* Mini Profile */
.user-mini {
    margin-top: auto; background: white; padding: 16px;
    border-radius: 16px; border: 1px solid #e2e8f0;
    display: flex; align-items: center; gap: 12px;
}
.avatar {
    width: 40px; height: 40px; background: #e0e7ff; color: var(--primary);
    border-radius: 10px; display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 1.1rem;
}

/* =========================================
   5. MAIN CONTENT
   ========================================= */
.main-content { padding: 40px 60px; }

/* HEADER & GREETING (ENHANCED) */
.header-section {
    display: flex; justify-content: space-between; align-items: flex-end;
    margin-bottom: 40px;
}
.greet-box h1 {
    font-size: 2.2rem; margin: 0; letter-spacing: -1px; color: var(--dark);
    line-height: 1.2;
}
.highlight-name {
    background: linear-gradient(135deg, var(--primary) 0%, #ec4899 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 800;
}
.wave-emoji {
    display: inline-block;
    animation: wave-animation 2.5s infinite;
    transform-origin: 70% 70%;
}
@keyframes wave-animation {
    0% { transform: rotate( 0.0deg) }
    10% { transform: rotate(14.0deg) }
    20% { transform: rotate(-8.0deg) }
    30% { transform: rotate(14.0deg) }
    40% { transform: rotate(-4.0deg) }
    50% { transform: rotate(10.0deg) }
    60% { transform: rotate( 0.0deg) }
    100% { transform: rotate( 0.0deg) }
}
.greet-sub {
    font-size: 1.05rem; color: #64748b; margin-top: 8px; font-weight: 500;
}
.date-badge {
    background: white; padding: 10px 20px; border-radius: 50px;
    font-weight: 600; color: var(--primary); border: 1px solid #e2e8f0;
    box-shadow: 0 4px 15px rgba(0,0,0,0.03); white-space: nowrap;
}

/* HERO CARD (INFO) */
.hero-card {
    background: white; border-radius: 24px; padding: 40px;
    box-shadow: var(--shadow-card); margin-bottom: 40px;
    border: 1px solid rgba(255,255,255,0.8);
    position: relative; overflow: hidden;
}
.hero-card::before {
    content:''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px;
    background: linear-gradient(to bottom, var(--primary), var(--secondary));
}
.hero-title { font-size: 1.5rem; font-weight: 800; color: var(--dark); margin-bottom: 15px; }
.hero-desc { font-size: 1rem; color: #475569; line-height: 1.7; max-width: 800px; }

/* ACTION GRID */
.action-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 30px;
}
.card-action {
    background: white; padding: 35px; border-radius: 20px;
    text-decoration: none; color: inherit;
    border: 1px solid #f1f5f9;
    box-shadow: var(--shadow-card);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative; overflow: hidden;
}
.card-action:hover {
    transform: translateY(-8px);
    border-color: var(--primary);
    box-shadow: 0 20px 40px -10px rgba(79, 70, 229, 0.15);
}
.icon-box {
    width: 60px; height: 60px; border-radius: 16px; margin-bottom: 25px;
    display: flex; align-items: center; justify-content: center; font-size: 1.8rem;
}
.ib-blue { background: #eff6ff; color: #2563eb; }
.ib-teal { background: #f0fdfa; color: #0d9488; }

.ca-title { font-size: 1.35rem; font-weight: 700; color: var(--dark); margin-bottom: 10px; }
.ca-desc { color: #64748b; font-size: 0.95rem; line-height: 1.6; margin-bottom: 25px; }
.btn-arrow {
    font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 6px;
    font-size: 0.95rem; transition: gap 0.2s;
}
.card-action:hover .btn-arrow { gap: 12px; }

/* MOBILE RESPONSIVE */
.menu-btn { display: none; font-size: 1.5rem; background: none; border: none; cursor: pointer; color: var(--dark); }
@media (max-width: 1000px) {
    .app-container { grid-template-columns: 1fr; }
    .sidebar { display: none; position: fixed; width: 280px; box-shadow: 10px 0 30px rgba(0,0,0,0.1); }
    .sidebar.active { display: flex; }
    .main-content { padding: 25px; }
    .action-grid { grid-template-columns: 1fr; }
    .menu-btn { display: block; margin-right: 15px; }
    .header-section { flex-direction: column; align-items: flex-start; gap: 20px; }
    .greet-box h1 { font-size: 1.8rem; }
}
</style>
</head>
<body>

    <div class="ambient-bg"></div>

    <div class="app-container">
        
        <aside class="sidebar" id="sidebar">
            <div class="brand">
                <img src="image/HASA.png" alt="Logo" style="height:36px;">
                <span class="brand-text">Sistem HASA</span>
            </div>

            <nav class="nav-links">
                <a href="dashboard.html" class="nav-item active">
                    <span class="nav-icon">üìä</span> Dashboard
                </a>
                <a href="contohawam.html" class="nav-item">
                    <span class="nav-icon">üèõÔ∏è</span> Kiraan Awam
                </a>
                <a href="swasta.html" class="nav-item">
                    <span class="nav-icon">üíº</span> Kiraan Swasta
                </a>
                <a href="profile.html" class="nav-item">
                    <span class="nav-icon">‚öôÔ∏è</span> Profil
                </a>
                <a href="#" id="logoutBtn" class="nav-item" style="color:#ef4444; margin-top:auto;">
                    <span class="nav-icon">üö™</span> Log Keluar
                </a>
            </nav>

            <div class="user-mini">
                <div class="avatar" id="sideAvatar">?</div>
                <div style="overflow:hidden;">
                    <div id="sideName" style="font-weight:700; font-size:0.9rem; white-space:nowrap;">Memuatkan...</div>
                    <div id="sideEmail" style="font-size:0.75rem; color:#94a3b8; text-overflow:ellipsis; overflow:hidden;">...</div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            
            <header class="header-section">
                <div style="display:flex; align-items:center;">
                    <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
                    
                    <div class="greet-box">
                        <h1 id="greetingTitle">
                            Selamat Datang <span class="wave-emoji">üëã</span>
                        </h1>
                        <p class="greet-sub" id="greetingSub">
                            Sistem sedia untuk membantu kiraan anda.
                        </p>
                    </div>

                </div>
                <div class="date-badge" id="liveDate">...</div>
            </header>

            <section class="hero-card">
                <h2 class="hero-title">Tentang Sistem Kalkulator Gaji HASA</h2>
                <p class="hero-desc">
                    Sistem ini direka khas untuk memudahkan <strong>Kakitangan, Pemohon, dan Unit Sumber Manusia (HR)</strong> membuat simulasi gaji.
                    Ia merangkumi struktur gaji <strong>Skim U</strong> (Sektor Awam) dan juga caruman pekerja (Sektor Swasta).
                </p>
                
                <div style="margin-top:20px; display:flex; gap:15px; flex-wrap:wrap;">
                    <span style="background:#f1f5f9; padding:8px 15px; border-radius:8px; font-size:0.85rem; font-weight:600; color:#64748b;">
                        ‚úÖ Rujukan Pantas
                    </span>
                    <span style="background:#f1f5f9; padding:8px 15px; border-radius:8px; font-size:0.85rem; font-weight:600; color:#64748b;">
                        ‚úÖ Kiraan Automatik
                    </span>
                    <span style="background:#f1f5f9; padding:8px 15px; border-radius:8px; font-size:0.85rem; font-weight:600; color:#64748b;">
                        ‚úÖ Data Selamat
                    </span>
                </div>
            </section>

            <section class="action-grid">
                
                <a href="contohawam.html" class="card-action">
                    <div class="icon-box ib-blue">üèõÔ∏è</div>
                    <div class="ca-title">Kiraan Sektor Awam</div>
                    <div class="ca-desc">
                       Panduan Kiraan
Kiraan Awam: Isikan Jawatan Kini, Wilayah Asal, pilih sama ada telah terima PGT tahun ini atau tidak, dan Bulan PGT. Elaun adalah tetap dan tidak boleh diubah. Tekan butang KIRA GAJI AWAM untuk melihat hasil.
                    </div>
                    <div class="btn-arrow">Mula Kira Sekarang ‚ûú</div>
                </a>

                <a href="swasta.html" class="card-action">
                    <div class="icon-box ib-teal">üíº</div>
                    <div class="ca-title">Kiraan Sektor Swasta</div>
                    <div class="ca-desc">
                        <b>Kiraan Swasta:</b> Pilih Jawatan, Wilayah Asal Pemohon dan isi Nama Majikan/Organisasi kemudian tempoh pengalaman (Tarikh Mula & Tamat). Sistem akan kira tempoh hari ‚Üí tahun ‚Üí 'Boleh Ambil Kira' secara automatik. Gaji Permulaan ditambah dengan PGT layak dan Elaun tetap. Tekan butang KIRA GAJI SWASTA untuk lihat hasil.


                    </div>
                    <div class="btn-arrow">Mula Kira Sekarang ‚ûú</div>
                </a>

            </section>

        </main>
    </div>

    <div id="accountData" style="display:none;"></div>
    <button id="sideLogoutBtn" style="display:none;"></button>

<script>
/* ===============================
   LOGIC SCRIPT
   =============================== */

// 1. Mobile Menu
function toggleMenu() {
    document.getElementById('sidebar').classList.toggle('active');
}

// 2. Date & Time Greetings
function updateTime() {
    const now = new Date();
    
    // Date
    const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
    document.getElementById('liveDate').textContent = now.toLocaleDateString('ms-MY', options);

    // Time Logic
    const h = now.getHours();
    let timeGreet = "Selamat Pagi";
    let subGreet = "Mulakan hari anda dengan senyuman!";
    
    if(h >= 12 && h < 14) {
        timeGreet = "Selamat Tengahari";
        subGreet = "Rehat sebentar dan semak rekod anda.";
    } else if(h >= 14 && h < 19) {
        timeGreet = "Selamat Petang";
        subGreet = "Teruskan produktiviti anda hari ini.";
    } else if(h >= 19) {
        timeGreet = "Selamat Malam";
        subGreet = "Ringkasan sistem & status semasa anda.";
    }

    window.greetingBase = timeGreet;
    window.subMsg = subGreet;
}
updateTime();

// 3. Firebase Auth
onAuthChange(async user => {
    if(!user){ location.href='login.html'; return; }

    try {
        const { data } = await getCurrentUserDoc();
        const fullname = data?.fullname || user.email.split('@')[0];
        const firstName = fullname.split(' ')[0].toUpperCase();

        // UPDATE GREETING (ENHANCED)
        const greetingHTML = `${window.greetingBase}, <br><span class="highlight-name">${fullname.toUpperCase()}</span>! <span class="wave-emoji">üëã</span>`;
        
        document.getElementById('greetingTitle').innerHTML = greetingHTML;
        document.getElementById('greetingSub').textContent = window.subMsg;

        // Update Sidebar
        document.getElementById('sideName').textContent = fullname;
        document.getElementById('sideEmail').textContent = user.email;
        document.getElementById('sideAvatar').textContent = firstName.charAt(0);

    } catch(e) { console.error(e); }
});

// 4. Logout
document.getElementById('logoutBtn').addEventListener('click', async (e) => {
    e.preventDefault();
    if(confirm('Anda pasti ingin log keluar?')) {
        await firebase.auth().signOut();
        window.location.href = 'login.html';
    }
});

</script>
</body>
</html>

